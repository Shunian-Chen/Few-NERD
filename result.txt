5-way-1-shot 
model: structshot
max_length: 64
mode: inter
loading model and tokenizer...
loading data...
use structshot
model-save-path: checkpoint/structshot-inter-5-1-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 217.930398 | [ENTITY] precision: 0.0150, recall: 0.0249, f1: 0.0187
step:  200 | loss: 116.985330 | [ENTITY] precision: 0.0159, recall: 0.0284, f1: 0.0204
step:  300 | loss: 81.154368 | [ENTITY] precision: 0.0151, recall: 0.0275, f1: 0.0195
step:  400 | loss: 62.745348 | [ENTITY] precision: 0.0146, recall: 0.0270, f1: 0.0189
step:  500 | loss: 51.427179 | [ENTITY] precision: 0.0147, recall: 0.0272, f1: 0.0191
step:  600 | loss: 43.739220 | [ENTITY] precision: 0.0144, recall: 0.0267, f1: 0.0187
step:  700 | loss: 38.138015 | [ENTITY] precision: 0.0150, recall: 0.0278, f1: 0.0195
step:  800 | loss: 33.817215 | [ENTITY] precision: 0.0157, recall: 0.0289, f1: 0.0203
step:  900 | loss: 30.424063 | [ENTITY] precision: 0.0163, recall: 0.0299, f1: 0.0210
step: 1000 | loss: 27.654333 | [ENTITY] precision: 0.0176, recall: 0.0322, f1: 0.0228
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2928, recall: 0.3001, f1: 0.2964
Best checkpoint
step: 1100 | loss: 2.630676 | [ENTITY] precision: 0.0315, recall: 0.0532, f1: 0.0396
step: 1200 | loss: 2.502465 | [ENTITY] precision: 0.0298, recall: 0.0508, f1: 0.0375
step: 1300 | loss: 2.362950 | [ENTITY] precision: 0.0327, recall: 0.0548, f1: 0.0409
step: 1400 | loss: 2.239665 | [ENTITY] precision: 0.0348, recall: 0.0582, f1: 0.0436
step: 1500 | loss: 2.161090 | [ENTITY] precision: 0.0363, recall: 0.0601, f1: 0.0452
step: 1600 | loss: 2.084573 | [ENTITY] precision: 0.0384, recall: 0.0629, f1: 0.0477
step: 1700 | loss: 2.043134 | [ENTITY] precision: 0.0401, recall: 0.0655, f1: 0.0498
step: 1800 | loss: 1.989504 | [ENTITY] precision: 0.0421, recall: 0.0681, f1: 0.0520
step: 1900 | loss: 1.932968 | [ENTITY] precision: 0.0441, recall: 0.0710, f1: 0.0545
step: 2000 | loss: 1.890177 | [ENTITY] precision: 0.0462, recall: 0.0738, f1: 0.0568
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3714, recall: 0.3653, f1: 0.3683
Best checkpoint
step: 2100 | loss: 1.335424 | [ENTITY] precision: 0.0781, recall: 0.1182, f1: 0.0941
step: 2200 | loss: 1.318143 | [ENTITY] precision: 0.0776, recall: 0.1157, f1: 0.0929
step: 2300 | loss: 1.313124 | [ENTITY] precision: 0.0792, recall: 0.1175, f1: 0.0946
step: 2400 | loss: 1.268872 | [ENTITY] precision: 0.0806, recall: 0.1198, f1: 0.0964
step: 2500 | loss: 1.256490 | [ENTITY] precision: 0.0829, recall: 0.1221, f1: 0.0988
step: 2600 | loss: 1.237272 | [ENTITY] precision: 0.0851, recall: 0.1251, f1: 0.1013
step: 2700 | loss: 1.225004 | [ENTITY] precision: 0.0879, recall: 0.1286, f1: 0.1044
step: 2800 | loss: 1.208912 | [ENTITY] precision: 0.0906, recall: 0.1318, f1: 0.1074
step: 2900 | loss: 1.208160 | [ENTITY] precision: 0.0925, recall: 0.1346, f1: 0.1097
step: 3000 | loss: 1.186815 | [ENTITY] precision: 0.0952, recall: 0.1380, f1: 0.1126
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3830, recall: 0.3677, f1: 0.3752
Best checkpoint
step: 3100 | loss: 0.998801 | [ENTITY] precision: 0.1258, recall: 0.1768, f1: 0.1470
step: 3200 | loss: 0.991747 | [ENTITY] precision: 0.1255, recall: 0.1742, f1: 0.1459
step: 3300 | loss: 0.961498 | [ENTITY] precision: 0.1285, recall: 0.1770, f1: 0.1489
step: 3400 | loss: 0.942305 | [ENTITY] precision: 0.1314, recall: 0.1796, f1: 0.1517
step: 3500 | loss: 0.946607 | [ENTITY] precision: 0.1347, recall: 0.1845, f1: 0.1557
step: 3600 | loss: 0.931314 | [ENTITY] precision: 0.1378, recall: 0.1880, f1: 0.1590
step: 3700 | loss: 0.909988 | [ENTITY] precision: 0.1410, recall: 0.1918, f1: 0.1625
step: 3800 | loss: 0.903036 | [ENTITY] precision: 0.1431, recall: 0.1943, f1: 0.1648
step: 3900 | loss: 0.888163 | [ENTITY] precision: 0.1455, recall: 0.1969, f1: 0.1673
step: 4000 | loss: 0.890040 | [ENTITY] precision: 0.1473, recall: 0.1992, f1: 0.1693
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3858, recall: 0.3564, f1: 0.3705
step: 4100 | loss: 0.687259 | [ENTITY] precision: 0.1795, recall: 0.2339, f1: 0.2031
step: 4200 | loss: 0.733804 | [ENTITY] precision: 0.1798, recall: 0.2321, f1: 0.2027
step: 4300 | loss: 0.722694 | [ENTITY] precision: 0.1806, recall: 0.2352, f1: 0.2043
step: 4400 | loss: 0.730775 | [ENTITY] precision: 0.1864, recall: 0.2413, f1: 0.2103
step: 4500 | loss: 0.711495 | [ENTITY] precision: 0.1901, recall: 0.2458, f1: 0.2144
step: 4600 | loss: 0.714647 | [ENTITY] precision: 0.1929, recall: 0.2498, f1: 0.2177
step: 4700 | loss: 0.711877 | [ENTITY] precision: 0.1954, recall: 0.2529, f1: 0.2205
step: 4800 | loss: 0.706885 | [ENTITY] precision: 0.1991, recall: 0.2569, f1: 0.2243
step: 4900 | loss: 0.700981 | [ENTITY] precision: 0.2020, recall: 0.2603, f1: 0.2275
step: 5000 | loss: 0.692998 | [ENTITY] precision: 0.2054, recall: 0.2643, f1: 0.2312
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3935, recall: 0.3455, f1: 0.3679
step: 5100 | loss: 0.515452 | [ENTITY] precision: 0.2360, recall: 0.3108, f1: 0.2683
step: 5200 | loss: 0.535558 | [ENTITY] precision: 0.2441, recall: 0.3128, f1: 0.2742
step: 5300 | loss: 0.527232 | [ENTITY] precision: 0.2462, recall: 0.3147, f1: 0.2762
step: 5400 | loss: 0.530381 | [ENTITY] precision: 0.2516, recall: 0.3198, f1: 0.2816
step: 5500 | loss: 0.520525 | [ENTITY] precision: 0.2561, recall: 0.3233, f1: 0.2858
step: 5600 | loss: 0.508797 | [ENTITY] precision: 0.2607, recall: 0.3281, f1: 0.2905
step: 5700 | loss: 0.525111 | [ENTITY] precision: 0.2642, recall: 0.3318, f1: 0.2942
step: 5800 | loss: 0.531282 | [ENTITY] precision: 0.2665, recall: 0.3338, f1: 0.2964
step: 5900 | loss: 0.532480 | [ENTITY] precision: 0.2689, recall: 0.3363, f1: 0.2989
step: 6000 | loss: 0.518120 | [ENTITY] precision: 0.2747, recall: 0.3417, f1: 0.3046
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3939, recall: 0.3303, f1: 0.3593
step: 6100 | loss: 0.424872 | [ENTITY] precision: 0.3139, recall: 0.3777, f1: 0.3429
step: 6200 | loss: 0.434535 | [ENTITY] precision: 0.3183, recall: 0.3820, f1: 0.3473
step: 6300 | loss: 0.409509 | [ENTITY] precision: 0.3261, recall: 0.3878, f1: 0.3543
step: 6400 | loss: 0.406122 | [ENTITY] precision: 0.3288, recall: 0.3898, f1: 0.3567
step: 6500 | loss: 0.400569 | [ENTITY] precision: 0.3312, recall: 0.3927, f1: 0.3593
step: 6600 | loss: 0.397601 | [ENTITY] precision: 0.3312, recall: 0.3930, f1: 0.3595
step: 6700 | loss: 0.392311 | [ENTITY] precision: 0.3344, recall: 0.3961, f1: 0.3627
step: 6800 | loss: 0.386206 | [ENTITY] precision: 0.3375, recall: 0.3997, f1: 0.3660
step: 6900 | loss: 0.380040 | [ENTITY] precision: 0.3412, recall: 0.4042, f1: 0.3700
step: 7000 | loss: 0.374890 | [ENTITY] precision: 0.3445, recall: 0.4076, f1: 0.3734
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4025, recall: 0.3191, f1: 0.3560
step: 7100 | loss: 0.392220 | [ENTITY] precision: 0.3720, recall: 0.4366, f1: 0.4017
step: 7200 | loss: 0.385093 | [ENTITY] precision: 0.3760, recall: 0.4401, f1: 0.4055
step: 7300 | loss: 0.365214 | [ENTITY] precision: 0.3750, recall: 0.4371, f1: 0.4037
step: 7400 | loss: 0.353271 | [ENTITY] precision: 0.3773, recall: 0.4388, f1: 0.4057
step: 7500 | loss: 0.341706 | [ENTITY] precision: 0.3812, recall: 0.4433, f1: 0.4099
step: 7600 | loss: 0.335651 | [ENTITY] precision: 0.3833, recall: 0.4457, f1: 0.4121
step: 7700 | loss: 0.336413 | [ENTITY] precision: 0.3861, recall: 0.4492, f1: 0.4153
step: 7800 | loss: 0.333203 | [ENTITY] precision: 0.3901, recall: 0.4537, f1: 0.4195
step: 7900 | loss: 0.330064 | [ENTITY] precision: 0.3945, recall: 0.4579, f1: 0.4238
step: 8000 | loss: 0.326311 | [ENTITY] precision: 0.3971, recall: 0.4610, f1: 0.4267
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3989, recall: 0.3042, f1: 0.3451
step: 8100 | loss: 0.287690 | [ENTITY] precision: 0.4371, recall: 0.4897, f1: 0.4619
step: 8200 | loss: 0.267655 | [ENTITY] precision: 0.4383, recall: 0.4962, f1: 0.4655
step: 8300 | loss: 0.267724 | [ENTITY] precision: 0.4449, recall: 0.4991, f1: 0.4705
step: 8400 | loss: 0.282997 | [ENTITY] precision: 0.4458, recall: 0.5017, f1: 0.4721
step: 8500 | loss: 0.281267 | [ENTITY] precision: 0.4474, recall: 0.5036, f1: 0.4739
step: 8600 | loss: 0.275263 | [ENTITY] precision: 0.4510, recall: 0.5067, f1: 0.4772
step: 8700 | loss: 0.275135 | [ENTITY] precision: 0.4528, recall: 0.5097, f1: 0.4796
step: 8800 | loss: 0.268558 | [ENTITY] precision: 0.4565, recall: 0.5137, f1: 0.4834
step: 8900 | loss: 0.266705 | [ENTITY] precision: 0.4597, recall: 0.5168, f1: 0.4865
step: 9000 | loss: 0.263397 | [ENTITY] precision: 0.4625, recall: 0.5199, f1: 0.4895
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3970, recall: 0.2921, f1: 0.3366
step: 9100 | loss: 0.226988 | [ENTITY] precision: 0.4923, recall: 0.5480, f1: 0.5187
step: 9200 | loss: 0.232122 | [ENTITY] precision: 0.4931, recall: 0.5491, f1: 0.5196
step: 9300 | loss: 0.234111 | [ENTITY] precision: 0.4920, recall: 0.5484, f1: 0.5187
step: 9400 | loss: 0.234598 | [ENTITY] precision: 0.4971, recall: 0.5547, f1: 0.5243
step: 9500 | loss: 0.228742 | [ENTITY] precision: 0.4976, recall: 0.5555, f1: 0.5250
step: 9600 | loss: 0.231257 | [ENTITY] precision: 0.5013, recall: 0.5585, f1: 0.5284
step: 9700 | loss: 0.230210 | [ENTITY] precision: 0.5031, recall: 0.5611, f1: 0.5305
step: 9800 | loss: 0.226864 | [ENTITY] precision: 0.5058, recall: 0.5623, f1: 0.5325
step: 9900 | loss: 0.223957 | [ENTITY] precision: 0.5075, recall: 0.5637, f1: 0.5341
step: 10000 | loss: 0.224410 | [ENTITY] precision: 0.5094, recall: 0.5655, f1: 0.5360
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3989, recall: 0.2888, f1: 0.3350

####################

Finish training structshot-inter-5-1-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/structshot-inter-5-1-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.5300, recall: 0.5137, f1: 0.5217
RESULT: precision: 0.5300, recall: 0.5137, f1:0.5217
ERROR ANALYSIS: fp: 0.0277, fn: 0.0360, within:0.0624, outer: 0.0928
------------------------
5-way-5-shot 
model: structshot
max_length: 32
mode: inter
loading model and tokenizer...
loading data...
use structshot
model-save-path: checkpoint/structshot-inter-5-5-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 174.281451 | [ENTITY] precision: 0.0262, recall: 0.0395, f1: 0.0315
step:  200 | loss: 99.520292 | [ENTITY] precision: 0.0194, recall: 0.0336, f1: 0.0246
step:  300 | loss: 71.278892 | [ENTITY] precision: 0.0151, recall: 0.0279, f1: 0.0196
step:  400 | loss: 55.877497 | [ENTITY] precision: 0.0131, recall: 0.0251, f1: 0.0173
step:  500 | loss: 46.590091 | [ENTITY] precision: 0.0119, recall: 0.0232, f1: 0.0158
step:  600 | loss: 40.033002 | [ENTITY] precision: 0.0113, recall: 0.0219, f1: 0.0149
step:  700 | loss: 34.975773 | [ENTITY] precision: 0.0105, recall: 0.0207, f1: 0.0140
step:  800 | loss: 31.028938 | [ENTITY] precision: 0.0104, recall: 0.0203, f1: 0.0137
step:  900 | loss: 27.911594 | [ENTITY] precision: 0.0103, recall: 0.0203, f1: 0.0137
step: 1000 | loss: 25.391506 | [ENTITY] precision: 0.0103, recall: 0.0202, f1: 0.0136
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3537, recall: 0.1632, f1: 0.2234
Best checkpoint
step: 1100 | loss: 2.495779 | [ENTITY] precision: 0.0131, recall: 0.0244, f1: 0.0170
step: 1200 | loss: 2.295273 | [ENTITY] precision: 0.0142, recall: 0.0265, f1: 0.0185
step: 1300 | loss: 2.225491 | [ENTITY] precision: 0.0153, recall: 0.0282, f1: 0.0198
step: 1400 | loss: 2.213104 | [ENTITY] precision: 0.0154, recall: 0.0285, f1: 0.0200
step: 1500 | loss: 2.179134 | [ENTITY] precision: 0.0153, recall: 0.0282, f1: 0.0198
step: 1600 | loss: 2.118614 | [ENTITY] precision: 0.0169, recall: 0.0311, f1: 0.0219
step: 1700 | loss: 2.077546 | [ENTITY] precision: 0.0181, recall: 0.0335, f1: 0.0235
step: 1800 | loss: 2.023395 | [ENTITY] precision: 0.0193, recall: 0.0353, f1: 0.0249
step: 1900 | loss: 1.985976 | [ENTITY] precision: 0.0202, recall: 0.0368, f1: 0.0261
step: 2000 | loss: 1.942453 | [ENTITY] precision: 0.0210, recall: 0.0385, f1: 0.0272
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3898, recall: 0.2479, f1: 0.3031
Best checkpoint
step: 2100 | loss: 1.637649 | [ENTITY] precision: 0.0376, recall: 0.0651, f1: 0.0476
step: 2200 | loss: 1.560318 | [ENTITY] precision: 0.0370, recall: 0.0626, f1: 0.0466
step: 2300 | loss: 1.545600 | [ENTITY] precision: 0.0356, recall: 0.0607, f1: 0.0449
step: 2400 | loss: 1.508184 | [ENTITY] precision: 0.0370, recall: 0.0635, f1: 0.0467
step: 2500 | loss: 1.487208 | [ENTITY] precision: 0.0373, recall: 0.0634, f1: 0.0469
step: 2600 | loss: 1.464480 | [ENTITY] precision: 0.0376, recall: 0.0636, f1: 0.0473
step: 2700 | loss: 1.453665 | [ENTITY] precision: 0.0387, recall: 0.0653, f1: 0.0486
step: 2800 | loss: 1.431770 | [ENTITY] precision: 0.0403, recall: 0.0675, f1: 0.0504
step: 2900 | loss: 1.412464 | [ENTITY] precision: 0.0407, recall: 0.0681, f1: 0.0510
step: 3000 | loss: 1.382420 | [ENTITY] precision: 0.0421, recall: 0.0703, f1: 0.0527
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4204, recall: 0.2692, f1: 0.3283
Best checkpoint
step: 3100 | loss: 1.260642 | [ENTITY] precision: 0.0494, recall: 0.0843, f1: 0.0623
step: 3200 | loss: 1.224962 | [ENTITY] precision: 0.0533, recall: 0.0903, f1: 0.0671
step: 3300 | loss: 1.179478 | [ENTITY] precision: 0.0549, recall: 0.0909, f1: 0.0684
step: 3400 | loss: 1.181733 | [ENTITY] precision: 0.0554, recall: 0.0919, f1: 0.0691
step: 3500 | loss: 1.177327 | [ENTITY] precision: 0.0590, recall: 0.0964, f1: 0.0732
step: 3600 | loss: 1.171048 | [ENTITY] precision: 0.0600, recall: 0.0978, f1: 0.0744
step: 3700 | loss: 1.156865 | [ENTITY] precision: 0.0624, recall: 0.1014, f1: 0.0773
step: 3800 | loss: 1.150227 | [ENTITY] precision: 0.0634, recall: 0.1028, f1: 0.0784
step: 3900 | loss: 1.129109 | [ENTITY] precision: 0.0645, recall: 0.1045, f1: 0.0798
step: 4000 | loss: 1.112500 | [ENTITY] precision: 0.0652, recall: 0.1050, f1: 0.0804
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4446, recall: 0.2939, f1: 0.3538
Best checkpoint
step: 4100 | loss: 0.998396 | [ENTITY] precision: 0.0751, recall: 0.1164, f1: 0.0913
step: 4200 | loss: 1.023718 | [ENTITY] precision: 0.0738, recall: 0.1140, f1: 0.0896
step: 4300 | loss: 1.026598 | [ENTITY] precision: 0.0784, recall: 0.1205, f1: 0.0950
step: 4400 | loss: 1.005305 | [ENTITY] precision: 0.0815, recall: 0.1247, f1: 0.0985
step: 4500 | loss: 0.965768 | [ENTITY] precision: 0.0855, recall: 0.1308, f1: 0.1034
step: 4600 | loss: 0.940970 | [ENTITY] precision: 0.0866, recall: 0.1323, f1: 0.1047
step: 4700 | loss: 0.933582 | [ENTITY] precision: 0.0886, recall: 0.1356, f1: 0.1072
step: 4800 | loss: 0.906928 | [ENTITY] precision: 0.0903, recall: 0.1382, f1: 0.1092
step: 4900 | loss: 0.881999 | [ENTITY] precision: 0.0917, recall: 0.1398, f1: 0.1107
step: 5000 | loss: 0.863919 | [ENTITY] precision: 0.0929, recall: 0.1413, f1: 0.1121
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4550, recall: 0.3368, f1: 0.3870
Best checkpoint
step: 5100 | loss: 0.654401 | [ENTITY] precision: 0.1076, recall: 0.1497, f1: 0.1252
step: 5200 | loss: 0.647613 | [ENTITY] precision: 0.1139, recall: 0.1586, f1: 0.1326
step: 5300 | loss: 0.629197 | [ENTITY] precision: 0.1176, recall: 0.1662, f1: 0.1378
step: 5400 | loss: 0.612623 | [ENTITY] precision: 0.1235, recall: 0.1744, f1: 0.1446
step: 5500 | loss: 0.605192 | [ENTITY] precision: 0.1259, recall: 0.1770, f1: 0.1472
step: 5600 | loss: 0.593742 | [ENTITY] precision: 0.1285, recall: 0.1806, f1: 0.1501
step: 5700 | loss: 0.591187 | [ENTITY] precision: 0.1303, recall: 0.1835, f1: 0.1524
step: 5800 | loss: 0.584027 | [ENTITY] precision: 0.1313, recall: 0.1846, f1: 0.1535
step: 5900 | loss: 0.575920 | [ENTITY] precision: 0.1350, recall: 0.1887, f1: 0.1574
step: 6000 | loss: 0.567257 | [ENTITY] precision: 0.1370, recall: 0.1910, f1: 0.1595
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4515, recall: 0.3363, f1: 0.3855
step: 6100 | loss: 0.541931 | [ENTITY] precision: 0.1598, recall: 0.2171, f1: 0.1841
step: 6200 | loss: 0.496360 | [ENTITY] precision: 0.1615, recall: 0.2192, f1: 0.1860
step: 6300 | loss: 0.494839 | [ENTITY] precision: 0.1676, recall: 0.2275, f1: 0.1930
step: 6400 | loss: 0.491090 | [ENTITY] precision: 0.1705, recall: 0.2305, f1: 0.1960
step: 6500 | loss: 0.491422 | [ENTITY] precision: 0.1721, recall: 0.2325, f1: 0.1978
step: 6600 | loss: 0.481767 | [ENTITY] precision: 0.1743, recall: 0.2366, f1: 0.2007
step: 6700 | loss: 0.475816 | [ENTITY] precision: 0.1749, recall: 0.2373, f1: 0.2014
step: 6800 | loss: 0.467071 | [ENTITY] precision: 0.1797, recall: 0.2420, f1: 0.2063
step: 6900 | loss: 0.459842 | [ENTITY] precision: 0.1822, recall: 0.2450, f1: 0.2090
step: 7000 | loss: 0.454536 | [ENTITY] precision: 0.1822, recall: 0.2450, f1: 0.2090
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4519, recall: 0.3385, f1: 0.3871
Best checkpoint
step: 7100 | loss: 0.407608 | [ENTITY] precision: 0.2171, recall: 0.2817, f1: 0.2453
step: 7200 | loss: 0.403599 | [ENTITY] precision: 0.2135, recall: 0.2821, f1: 0.2431
step: 7300 | loss: 0.399553 | [ENTITY] precision: 0.2103, recall: 0.2800, f1: 0.2402
step: 7400 | loss: 0.399711 | [ENTITY] precision: 0.2102, recall: 0.2790, f1: 0.2398
step: 7500 | loss: 0.393124 | [ENTITY] precision: 0.2130, recall: 0.2814, f1: 0.2425
step: 7600 | loss: 0.389634 | [ENTITY] precision: 0.2185, recall: 0.2865, f1: 0.2479
step: 7700 | loss: 0.385442 | [ENTITY] precision: 0.2215, recall: 0.2902, f1: 0.2512
step: 7800 | loss: 0.382853 | [ENTITY] precision: 0.2271, recall: 0.2951, f1: 0.2567
step: 7900 | loss: 0.380035 | [ENTITY] precision: 0.2298, recall: 0.2979, f1: 0.2594
step: 8000 | loss: 0.377964 | [ENTITY] precision: 0.2330, recall: 0.3019, f1: 0.2630
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4533, recall: 0.3321, f1: 0.3833
step: 8100 | loss: 0.372312 | [ENTITY] precision: 0.2460, recall: 0.3171, f1: 0.2771
step: 8200 | loss: 0.363053 | [ENTITY] precision: 0.2604, recall: 0.3361, f1: 0.2934
step: 8300 | loss: 0.358961 | [ENTITY] precision: 0.2595, recall: 0.3322, f1: 0.2914
step: 8400 | loss: 0.354664 | [ENTITY] precision: 0.2599, recall: 0.3304, f1: 0.2909
step: 8500 | loss: 0.347854 | [ENTITY] precision: 0.2608, recall: 0.3303, f1: 0.2915
step: 8600 | loss: 0.343544 | [ENTITY] precision: 0.2646, recall: 0.3349, f1: 0.2956
step: 8700 | loss: 0.339046 | [ENTITY] precision: 0.2665, recall: 0.3378, f1: 0.2980
step: 8800 | loss: 0.336091 | [ENTITY] precision: 0.2700, recall: 0.3416, f1: 0.3016
step: 8900 | loss: 0.333391 | [ENTITY] precision: 0.2734, recall: 0.3448, f1: 0.3050
step: 9000 | loss: 0.332055 | [ENTITY] precision: 0.2755, recall: 0.3468, f1: 0.3071
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4415, recall: 0.3107, f1: 0.3647
step: 9100 | loss: 0.297487 | [ENTITY] precision: 0.3012, recall: 0.3670, f1: 0.3308
step: 9200 | loss: 0.292008 | [ENTITY] precision: 0.3057, recall: 0.3748, f1: 0.3367
step: 9300 | loss: 0.290984 | [ENTITY] precision: 0.3070, recall: 0.3798, f1: 0.3395
step: 9400 | loss: 0.289174 | [ENTITY] precision: 0.3094, recall: 0.3830, f1: 0.3423
step: 9500 | loss: 0.288432 | [ENTITY] precision: 0.3128, recall: 0.3878, f1: 0.3463
step: 9600 | loss: 0.284720 | [ENTITY] precision: 0.3168, recall: 0.3921, f1: 0.3504
step: 9700 | loss: 0.283333 | [ENTITY] precision: 0.3194, recall: 0.3929, f1: 0.3523
step: 9800 | loss: 0.282581 | [ENTITY] precision: 0.3206, recall: 0.3937, f1: 0.3534
step: 9900 | loss: 0.281306 | [ENTITY] precision: 0.3232, recall: 0.3961, f1: 0.3559
step: 10000 | loss: 0.280979 | [ENTITY] precision: 0.3246, recall: 0.3972, f1: 0.3572
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4526, recall: 0.3274, f1: 0.3800

####################

Finish training structshot-inter-5-5-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/structshot-inter-5-5-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.5954, recall: 0.4914, f1: 0.5384
RESULT: precision: 0.5954, recall: 0.4914, f1:0.5384
ERROR ANALYSIS: fp: 0.0304, fn: 0.0498, within:0.0385, outer: 0.0595
------------------------
10-way-1-shot 
model: structshot
max_length: 64
mode: inter
loading model and tokenizer...
loading data...
use structshot
model-save-path: checkpoint/structshot-inter-10-1-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 271.243647 | [ENTITY] precision: 0.0093, recall: 0.0158, f1: 0.0117
step:  200 | loss: 150.103530 | [ENTITY] precision: 0.0079, recall: 0.0148, f1: 0.0103
step:  300 | loss: 105.017950 | [ENTITY] precision: 0.0076, recall: 0.0146, f1: 0.0100
step:  400 | loss: 81.137640 | [ENTITY] precision: 0.0079, recall: 0.0155, f1: 0.0105
step:  500 | loss: 66.474809 | [ENTITY] precision: 0.0083, recall: 0.0164, f1: 0.0111
step:  600 | loss: 56.715015 | [ENTITY] precision: 0.0077, recall: 0.0153, f1: 0.0103
step:  700 | loss: 49.624260 | [ENTITY] precision: 0.0075, recall: 0.0150, f1: 0.0100
step:  800 | loss: 44.216817 | [ENTITY] precision: 0.0074, recall: 0.0149, f1: 0.0099
step:  900 | loss: 39.899300 | [ENTITY] precision: 0.0076, recall: 0.0151, f1: 0.0101
step: 1000 | loss: 36.425650 | [ENTITY] precision: 0.0075, recall: 0.0149, f1: 0.0100
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2035, recall: 0.1927, f1: 0.1980
Best checkpoint
step: 1100 | loss: 4.532067 | [ENTITY] precision: 0.0096, recall: 0.0192, f1: 0.0128
step: 1200 | loss: 4.224503 | [ENTITY] precision: 0.0086, recall: 0.0173, f1: 0.0115
step: 1300 | loss: 3.920329 | [ENTITY] precision: 0.0100, recall: 0.0203, f1: 0.0134
step: 1400 | loss: 3.737615 | [ENTITY] precision: 0.0110, recall: 0.0218, f1: 0.0146
step: 1500 | loss: 3.582458 | [ENTITY] precision: 0.0117, recall: 0.0226, f1: 0.0154
step: 1600 | loss: 3.443019 | [ENTITY] precision: 0.0119, recall: 0.0229, f1: 0.0157
step: 1700 | loss: 3.345708 | [ENTITY] precision: 0.0125, recall: 0.0237, f1: 0.0164
step: 1800 | loss: 3.252823 | [ENTITY] precision: 0.0134, recall: 0.0251, f1: 0.0175
step: 1900 | loss: 3.208461 | [ENTITY] precision: 0.0141, recall: 0.0264, f1: 0.0184
step: 2000 | loss: 3.114095 | [ENTITY] precision: 0.0144, recall: 0.0268, f1: 0.0188
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2629, recall: 0.2384, f1: 0.2500
Best checkpoint
step: 2100 | loss: 2.063894 | [ENTITY] precision: 0.0211, recall: 0.0370, f1: 0.0269
step: 2200 | loss: 2.045859 | [ENTITY] precision: 0.0196, recall: 0.0348, f1: 0.0251
step: 2300 | loss: 2.079777 | [ENTITY] precision: 0.0205, recall: 0.0366, f1: 0.0263
step: 2400 | loss: 2.077349 | [ENTITY] precision: 0.0203, recall: 0.0359, f1: 0.0260
step: 2500 | loss: 2.058654 | [ENTITY] precision: 0.0208, recall: 0.0366, f1: 0.0265
step: 2600 | loss: 2.030108 | [ENTITY] precision: 0.0229, recall: 0.0400, f1: 0.0291
step: 2700 | loss: 2.061763 | [ENTITY] precision: 0.0232, recall: 0.0402, f1: 0.0294
step: 2800 | loss: 2.049840 | [ENTITY] precision: 0.0240, recall: 0.0412, f1: 0.0303
step: 2900 | loss: 2.013035 | [ENTITY] precision: 0.0243, recall: 0.0419, f1: 0.0308
step: 3000 | loss: 1.979140 | [ENTITY] precision: 0.0246, recall: 0.0421, f1: 0.0311
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2773, recall: 0.2478, f1: 0.2618
Best checkpoint
step: 3100 | loss: 1.726752 | [ENTITY] precision: 0.0290, recall: 0.0495, f1: 0.0366
step: 3200 | loss: 1.643080 | [ENTITY] precision: 0.0267, recall: 0.0437, f1: 0.0331
step: 3300 | loss: 1.550159 | [ENTITY] precision: 0.0292, recall: 0.0479, f1: 0.0363
step: 3400 | loss: 1.554000 | [ENTITY] precision: 0.0319, recall: 0.0516, f1: 0.0394
step: 3500 | loss: 1.517646 | [ENTITY] precision: 0.0340, recall: 0.0547, f1: 0.0420
step: 3600 | loss: 1.504228 | [ENTITY] precision: 0.0366, recall: 0.0591, f1: 0.0452
step: 3700 | loss: 1.503265 | [ENTITY] precision: 0.0386, recall: 0.0620, f1: 0.0476
step: 3800 | loss: 1.473803 | [ENTITY] precision: 0.0392, recall: 0.0627, f1: 0.0482
step: 3900 | loss: 1.464558 | [ENTITY] precision: 0.0401, recall: 0.0636, f1: 0.0492
step: 4000 | loss: 1.452160 | [ENTITY] precision: 0.0407, recall: 0.0644, f1: 0.0499
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2947, recall: 0.2700, f1: 0.2818
Best checkpoint
step: 4100 | loss: 1.354680 | [ENTITY] precision: 0.0620, recall: 0.0948, f1: 0.0750
step: 4200 | loss: 1.264066 | [ENTITY] precision: 0.0609, recall: 0.0909, f1: 0.0729
step: 4300 | loss: 1.317733 | [ENTITY] precision: 0.0623, recall: 0.0935, f1: 0.0748
step: 4400 | loss: 1.300378 | [ENTITY] precision: 0.0625, recall: 0.0930, f1: 0.0748
step: 4500 | loss: 1.305683 | [ENTITY] precision: 0.0642, recall: 0.0959, f1: 0.0769
step: 4600 | loss: 1.286072 | [ENTITY] precision: 0.0646, recall: 0.0963, f1: 0.0773
step: 4700 | loss: 1.272436 | [ENTITY] precision: 0.0651, recall: 0.0965, f1: 0.0778
step: 4800 | loss: 1.233718 | [ENTITY] precision: 0.0674, recall: 0.0991, f1: 0.0802
step: 4900 | loss: 1.211077 | [ENTITY] precision: 0.0685, recall: 0.1006, f1: 0.0815
step: 5000 | loss: 1.224648 | [ENTITY] precision: 0.0683, recall: 0.1002, f1: 0.0813
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3066, recall: 0.2757, f1: 0.2904
Best checkpoint
step: 5100 | loss: 1.086998 | [ENTITY] precision: 0.0810, recall: 0.1202, f1: 0.0968
step: 5200 | loss: 1.121495 | [ENTITY] precision: 0.0764, recall: 0.1127, f1: 0.0911
step: 5300 | loss: 1.126528 | [ENTITY] precision: 0.0817, recall: 0.1177, f1: 0.0964
step: 5400 | loss: 1.131630 | [ENTITY] precision: 0.0836, recall: 0.1211, f1: 0.0989
step: 5500 | loss: 1.105242 | [ENTITY] precision: 0.0881, recall: 0.1274, f1: 0.1042
step: 5600 | loss: 1.079262 | [ENTITY] precision: 0.0904, recall: 0.1294, f1: 0.1065
step: 5700 | loss: 1.058893 | [ENTITY] precision: 0.0898, recall: 0.1290, f1: 0.1059
step: 5800 | loss: 1.055674 | [ENTITY] precision: 0.0910, recall: 0.1302, f1: 0.1071
step: 5900 | loss: 1.053078 | [ENTITY] precision: 0.0913, recall: 0.1299, f1: 0.1072
step: 6000 | loss: 1.035679 | [ENTITY] precision: 0.0924, recall: 0.1307, f1: 0.1083
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2995, recall: 0.2688, f1: 0.2833
step: 6100 | loss: 0.834105 | [ENTITY] precision: 0.1122, recall: 0.1578, f1: 0.1311
step: 6200 | loss: 0.804680 | [ENTITY] precision: 0.1220, recall: 0.1688, f1: 0.1416
step: 6300 | loss: 0.877566 | [ENTITY] precision: 0.1201, recall: 0.1658, f1: 0.1393
step: 6400 | loss: 0.878257 | [ENTITY] precision: 0.1225, recall: 0.1698, f1: 0.1423
step: 6500 | loss: 0.834781 | [ENTITY] precision: 0.1254, recall: 0.1716, f1: 0.1449
step: 6600 | loss: 0.814598 | [ENTITY] precision: 0.1278, recall: 0.1734, f1: 0.1471
step: 6700 | loss: 0.799059 | [ENTITY] precision: 0.1299, recall: 0.1769, f1: 0.1498
step: 6800 | loss: 0.809489 | [ENTITY] precision: 0.1320, recall: 0.1795, f1: 0.1521
step: 6900 | loss: 0.808695 | [ENTITY] precision: 0.1323, recall: 0.1791, f1: 0.1522
step: 7000 | loss: 0.800425 | [ENTITY] precision: 0.1343, recall: 0.1821, f1: 0.1546
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3105, recall: 0.2665, f1: 0.2869
step: 7100 | loss: 0.634764 | [ENTITY] precision: 0.1573, recall: 0.2005, f1: 0.1763
step: 7200 | loss: 0.654310 | [ENTITY] precision: 0.1579, recall: 0.2045, f1: 0.1782
step: 7300 | loss: 0.651070 | [ENTITY] precision: 0.1628, recall: 0.2099, f1: 0.1834
step: 7400 | loss: 0.653978 | [ENTITY] precision: 0.1585, recall: 0.2029, f1: 0.1779
step: 7500 | loss: 0.647441 | [ENTITY] precision: 0.1629, recall: 0.2074, f1: 0.1825
step: 7600 | loss: 0.665636 | [ENTITY] precision: 0.1649, recall: 0.2102, f1: 0.1848
step: 7700 | loss: 0.672098 | [ENTITY] precision: 0.1676, recall: 0.2131, f1: 0.1876
step: 7800 | loss: 0.668770 | [ENTITY] precision: 0.1685, recall: 0.2157, f1: 0.1892
step: 7900 | loss: 0.674684 | [ENTITY] precision: 0.1695, recall: 0.2164, f1: 0.1901
step: 8000 | loss: 0.658874 | [ENTITY] precision: 0.1744, recall: 0.2221, f1: 0.1954
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3230, recall: 0.2736, f1: 0.2963
Best checkpoint
step: 8100 | loss: 0.537527 | [ENTITY] precision: 0.2134, recall: 0.2644, f1: 0.2361
step: 8200 | loss: 0.509624 | [ENTITY] precision: 0.2093, recall: 0.2618, f1: 0.2326
step: 8300 | loss: 0.611008 | [ENTITY] precision: 0.2067, recall: 0.2576, f1: 0.2293
step: 8400 | loss: 0.602089 | [ENTITY] precision: 0.2087, recall: 0.2596, f1: 0.2314
step: 8500 | loss: 0.614845 | [ENTITY] precision: 0.2145, recall: 0.2664, f1: 0.2377
step: 8600 | loss: 0.585820 | [ENTITY] precision: 0.2185, recall: 0.2696, f1: 0.2414
step: 8700 | loss: 0.568540 | [ENTITY] precision: 0.2203, recall: 0.2704, f1: 0.2428
step: 8800 | loss: 0.554430 | [ENTITY] precision: 0.2220, recall: 0.2726, f1: 0.2447
step: 8900 | loss: 0.551744 | [ENTITY] precision: 0.2251, recall: 0.2765, f1: 0.2482
step: 9000 | loss: 0.550258 | [ENTITY] precision: 0.2282, recall: 0.2808, f1: 0.2518
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3276, recall: 0.2712, f1: 0.2968
Best checkpoint
step: 9100 | loss: 0.420958 | [ENTITY] precision: 0.2583, recall: 0.3044, f1: 0.2795
step: 9200 | loss: 0.429771 | [ENTITY] precision: 0.2529, recall: 0.3027, f1: 0.2755
step: 9300 | loss: 0.469694 | [ENTITY] precision: 0.2586, recall: 0.3132, f1: 0.2833
step: 9400 | loss: 0.475505 | [ENTITY] precision: 0.2639, recall: 0.3142, f1: 0.2868
step: 9500 | loss: 0.459017 | [ENTITY] precision: 0.2607, recall: 0.3114, f1: 0.2838
step: 9600 | loss: 0.451412 | [ENTITY] precision: 0.2609, recall: 0.3118, f1: 0.2841
step: 9700 | loss: 0.439652 | [ENTITY] precision: 0.2620, recall: 0.3128, f1: 0.2851
step: 9800 | loss: 0.439763 | [ENTITY] precision: 0.2628, recall: 0.3132, f1: 0.2858
step: 9900 | loss: 0.438358 | [ENTITY] precision: 0.2666, recall: 0.3168, f1: 0.2895
step: 10000 | loss: 0.433445 | [ENTITY] precision: 0.2695, recall: 0.3192, f1: 0.2923
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3249, recall: 0.2631, f1: 0.2908

####################

Finish training structshot-inter-10-1-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/structshot-inter-10-1-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.4645, recall: 0.4135, f1: 0.4375
RESULT: precision: 0.4645, recall: 0.4135, f1:0.4375
ERROR ANALYSIS: fp: 0.0291, fn: 0.0448, within:0.1259, outer: 0.1294
------------------------
10-way-5-shot 
model: structshot
max_length: 32
mode: inter
loading model and tokenizer...
loading data...
use structshot
model-save-path: checkpoint/structshot-inter-10-5-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 178.287100 | [ENTITY] precision: 0.0140, recall: 0.0249, f1: 0.0179
step:  200 | loss: 101.738658 | [ENTITY] precision: 0.0102, recall: 0.0199, f1: 0.0135
step:  300 | loss: 72.290369 | [ENTITY] precision: 0.0086, recall: 0.0171, f1: 0.0114
step:  400 | loss: 56.793517 | [ENTITY] precision: 0.0075, recall: 0.0154, f1: 0.0101
step:  500 | loss: 47.062060 | [ENTITY] precision: 0.0065, recall: 0.0137, f1: 0.0088
step:  600 | loss: 40.339004 | [ENTITY] precision: 0.0059, recall: 0.0124, f1: 0.0080
step:  700 | loss: 35.327796 | [ENTITY] precision: 0.0055, recall: 0.0118, f1: 0.0075
step:  800 | loss: 31.610625 | [ENTITY] precision: 0.0051, recall: 0.0109, f1: 0.0069
step:  900 | loss: 28.568360 | [ENTITY] precision: 0.0049, recall: 0.0106, f1: 0.0067
step: 1000 | loss: 26.034132 | [ENTITY] precision: 0.0050, recall: 0.0106, f1: 0.0068
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3248, recall: 0.0877, f1: 0.1381
Best checkpoint
step: 1100 | loss: 2.718240 | [ENTITY] precision: 0.0046, recall: 0.0101, f1: 0.0063
step: 1200 | loss: 2.738165 | [ENTITY] precision: 0.0047, recall: 0.0101, f1: 0.0064
step: 1300 | loss: 2.588629 | [ENTITY] precision: 0.0065, recall: 0.0137, f1: 0.0088
step: 1400 | loss: 2.494374 | [ENTITY] precision: 0.0067, recall: 0.0139, f1: 0.0091
step: 1500 | loss: 2.406526 | [ENTITY] precision: 0.0077, recall: 0.0158, f1: 0.0104
step: 1600 | loss: 2.324561 | [ENTITY] precision: 0.0086, recall: 0.0176, f1: 0.0116
step: 1700 | loss: 2.286833 | [ENTITY] precision: 0.0091, recall: 0.0184, f1: 0.0122
step: 1800 | loss: 2.213223 | [ENTITY] precision: 0.0100, recall: 0.0199, f1: 0.0133
step: 1900 | loss: 2.170672 | [ENTITY] precision: 0.0105, recall: 0.0207, f1: 0.0140
step: 2000 | loss: 2.131077 | [ENTITY] precision: 0.0108, recall: 0.0211, f1: 0.0143
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3553, recall: 0.1671, f1: 0.2273
Best checkpoint
step: 2100 | loss: 1.846215 | [ENTITY] precision: 0.0204, recall: 0.0366, f1: 0.0262
step: 2200 | loss: 1.681943 | [ENTITY] precision: 0.0204, recall: 0.0354, f1: 0.0259
step: 2300 | loss: 1.606887 | [ENTITY] precision: 0.0214, recall: 0.0375, f1: 0.0272
step: 2400 | loss: 1.623836 | [ENTITY] precision: 0.0218, recall: 0.0388, f1: 0.0279
step: 2500 | loss: 1.564415 | [ENTITY] precision: 0.0224, recall: 0.0401, f1: 0.0288
step: 2600 | loss: 1.573464 | [ENTITY] precision: 0.0230, recall: 0.0409, f1: 0.0294
step: 2700 | loss: 1.594997 | [ENTITY] precision: 0.0237, recall: 0.0418, f1: 0.0302
step: 2800 | loss: 1.559154 | [ENTITY] precision: 0.0242, recall: 0.0428, f1: 0.0309
step: 2900 | loss: 1.537451 | [ENTITY] precision: 0.0247, recall: 0.0438, f1: 0.0316
step: 3000 | loss: 1.501074 | [ENTITY] precision: 0.0253, recall: 0.0444, f1: 0.0323
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3657, recall: 0.2050, f1: 0.2627
Best checkpoint
step: 3100 | loss: 1.258727 | [ENTITY] precision: 0.0361, recall: 0.0625, f1: 0.0458
step: 3200 | loss: 1.270008 | [ENTITY] precision: 0.0316, recall: 0.0527, f1: 0.0395
step: 3300 | loss: 1.229084 | [ENTITY] precision: 0.0320, recall: 0.0540, f1: 0.0402
step: 3400 | loss: 1.208350 | [ENTITY] precision: 0.0331, recall: 0.0561, f1: 0.0416
step: 3500 | loss: 1.202990 | [ENTITY] precision: 0.0359, recall: 0.0601, f1: 0.0449
step: 3600 | loss: 1.211008 | [ENTITY] precision: 0.0367, recall: 0.0615, f1: 0.0459
step: 3700 | loss: 1.184837 | [ENTITY] precision: 0.0376, recall: 0.0622, f1: 0.0469
step: 3800 | loss: 1.167199 | [ENTITY] precision: 0.0382, recall: 0.0631, f1: 0.0476
step: 3900 | loss: 1.142461 | [ENTITY] precision: 0.0389, recall: 0.0639, f1: 0.0483
step: 4000 | loss: 1.138490 | [ENTITY] precision: 0.0402, recall: 0.0659, f1: 0.0500
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3822, recall: 0.2384, f1: 0.2936
Best checkpoint
step: 4100 | loss: 1.093910 | [ENTITY] precision: 0.0480, recall: 0.0807, f1: 0.0602
step: 4200 | loss: 1.070823 | [ENTITY] precision: 0.0469, recall: 0.0780, f1: 0.0586
step: 4300 | loss: 1.084730 | [ENTITY] precision: 0.0501, recall: 0.0816, f1: 0.0621
step: 4400 | loss: 1.056677 | [ENTITY] precision: 0.0534, recall: 0.0873, f1: 0.0663
step: 4500 | loss: 1.064491 | [ENTITY] precision: 0.0548, recall: 0.0888, f1: 0.0678
step: 4600 | loss: 1.049004 | [ENTITY] precision: 0.0553, recall: 0.0894, f1: 0.0683
step: 4700 | loss: 1.031743 | [ENTITY] precision: 0.0572, recall: 0.0916, f1: 0.0704
step: 4800 | loss: 1.022048 | [ENTITY] precision: 0.0575, recall: 0.0924, f1: 0.0709
step: 4900 | loss: 0.997271 | [ENTITY] precision: 0.0592, recall: 0.0945, f1: 0.0728
step: 5000 | loss: 0.983980 | [ENTITY] precision: 0.0599, recall: 0.0950, f1: 0.0734
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3835, recall: 0.2515, f1: 0.3038
Best checkpoint
step: 5100 | loss: 0.773365 | [ENTITY] precision: 0.0790, recall: 0.1179, f1: 0.0946
step: 5200 | loss: 0.846872 | [ENTITY] precision: 0.0825, recall: 0.1256, f1: 0.0996
step: 5300 | loss: 0.820188 | [ENTITY] precision: 0.0882, recall: 0.1342, f1: 0.1064
step: 5400 | loss: 0.833555 | [ENTITY] precision: 0.0851, recall: 0.1307, f1: 0.1031
step: 5500 | loss: 0.846951 | [ENTITY] precision: 0.0832, recall: 0.1285, f1: 0.1010
step: 5600 | loss: 0.846891 | [ENTITY] precision: 0.0850, recall: 0.1324, f1: 0.1035
step: 5700 | loss: 0.839989 | [ENTITY] precision: 0.0868, recall: 0.1346, f1: 0.1055
step: 5800 | loss: 0.832330 | [ENTITY] precision: 0.0877, recall: 0.1353, f1: 0.1064
step: 5900 | loss: 0.813973 | [ENTITY] precision: 0.0905, recall: 0.1394, f1: 0.1098
step: 6000 | loss: 0.802217 | [ENTITY] precision: 0.0921, recall: 0.1417, f1: 0.1116
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3986, recall: 0.2974, f1: 0.3407
Best checkpoint
step: 6100 | loss: 0.722512 | [ENTITY] precision: 0.0968, recall: 0.1439, f1: 0.1157
step: 6200 | loss: 0.663555 | [ENTITY] precision: 0.1040, recall: 0.1505, f1: 0.1230
step: 6300 | loss: 0.667235 | [ENTITY] precision: 0.1069, recall: 0.1554, f1: 0.1267
step: 6400 | loss: 0.659095 | [ENTITY] precision: 0.1145, recall: 0.1644, f1: 0.1350
step: 6500 | loss: 0.643882 | [ENTITY] precision: 0.1119, recall: 0.1607, f1: 0.1320
step: 6600 | loss: 0.646785 | [ENTITY] precision: 0.1149, recall: 0.1648, f1: 0.1354
step: 6700 | loss: 0.630212 | [ENTITY] precision: 0.1176, recall: 0.1681, f1: 0.1384
step: 6800 | loss: 0.617549 | [ENTITY] precision: 0.1217, recall: 0.1738, f1: 0.1431
step: 6900 | loss: 0.614733 | [ENTITY] precision: 0.1231, recall: 0.1750, f1: 0.1445
step: 7000 | loss: 0.606061 | [ENTITY] precision: 0.1260, recall: 0.1788, f1: 0.1478
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3865, recall: 0.2763, f1: 0.3222
step: 7100 | loss: 0.545473 | [ENTITY] precision: 0.1519, recall: 0.2140, f1: 0.1777
step: 7200 | loss: 0.561336 | [ENTITY] precision: 0.1433, recall: 0.2064, f1: 0.1691
step: 7300 | loss: 0.525121 | [ENTITY] precision: 0.1598, recall: 0.2235, f1: 0.1863
step: 7400 | loss: 0.514396 | [ENTITY] precision: 0.1642, recall: 0.2271, f1: 0.1906
step: 7500 | loss: 0.510592 | [ENTITY] precision: 0.1653, recall: 0.2285, f1: 0.1918
step: 7600 | loss: 0.503466 | [ENTITY] precision: 0.1684, recall: 0.2320, f1: 0.1951
step: 7700 | loss: 0.497299 | [ENTITY] precision: 0.1684, recall: 0.2315, f1: 0.1950
step: 7800 | loss: 0.486469 | [ENTITY] precision: 0.1698, recall: 0.2327, f1: 0.1963
step: 7900 | loss: 0.484875 | [ENTITY] precision: 0.1692, recall: 0.2318, f1: 0.1956
step: 8000 | loss: 0.480725 | [ENTITY] precision: 0.1726, recall: 0.2358, f1: 0.1993
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3781, recall: 0.2639, f1: 0.3109
step: 8100 | loss: 0.455534 | [ENTITY] precision: 0.1882, recall: 0.2576, f1: 0.2175
step: 8200 | loss: 0.433545 | [ENTITY] precision: 0.1931, recall: 0.2630, f1: 0.2227
step: 8300 | loss: 0.427786 | [ENTITY] precision: 0.1968, recall: 0.2671, f1: 0.2266
step: 8400 | loss: 0.423671 | [ENTITY] precision: 0.1972, recall: 0.2664, f1: 0.2266
step: 8500 | loss: 0.416418 | [ENTITY] precision: 0.1991, recall: 0.2679, f1: 0.2284
step: 8600 | loss: 0.412911 | [ENTITY] precision: 0.2044, recall: 0.2732, f1: 0.2338
step: 8700 | loss: 0.408603 | [ENTITY] precision: 0.2090, recall: 0.2779, f1: 0.2386
step: 8800 | loss: 0.402757 | [ENTITY] precision: 0.2100, recall: 0.2775, f1: 0.2390
step: 8900 | loss: 0.399883 | [ENTITY] precision: 0.2119, recall: 0.2798, f1: 0.2411
step: 9000 | loss: 0.402420 | [ENTITY] precision: 0.2139, recall: 0.2821, f1: 0.2433
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4045, recall: 0.2774, f1: 0.3291
step: 9100 | loss: 0.357480 | [ENTITY] precision: 0.2380, recall: 0.3032, f1: 0.2667
step: 9200 | loss: 0.354926 | [ENTITY] precision: 0.2460, recall: 0.3069, f1: 0.2731
step: 9300 | loss: 0.364651 | [ENTITY] precision: 0.2434, recall: 0.3053, f1: 0.2708
step: 9400 | loss: 0.359862 | [ENTITY] precision: 0.2474, recall: 0.3101, f1: 0.2752
step: 9500 | loss: 0.359692 | [ENTITY] precision: 0.2477, recall: 0.3125, f1: 0.2763
step: 9600 | loss: 0.352080 | [ENTITY] precision: 0.2474, recall: 0.3129, f1: 0.2764
step: 9700 | loss: 0.348387 | [ENTITY] precision: 0.2498, recall: 0.3136, f1: 0.2781
step: 9800 | loss: 0.346723 | [ENTITY] precision: 0.2518, recall: 0.3170, f1: 0.2806
step: 9900 | loss: 0.346640 | [ENTITY] precision: 0.2484, recall: 0.3145, f1: 0.2775
step: 10000 | loss: 0.344209 | [ENTITY] precision: 0.2504, recall: 0.3164, f1: 0.2796
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.4017, recall: 0.2788, f1: 0.3292

####################

Finish training structshot-inter-10-5-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/structshot-inter-10-5-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.5473, recall: 0.4663, f1: 0.5036
RESULT: precision: 0.5473, recall: 0.4663, f1:0.5036
ERROR ANALYSIS: fp: 0.0246, fn: 0.0423, within:0.0813, outer: 0.0891
------------------------
5-way-1-shot 
model: proto
max_length: 64
mode: inter
loading model and tokenizer...
loading data...
use proto
model-save-path: checkpoint/proto-inter-5-1-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 147.114156 | [ENTITY] precision: 0.0183, recall: 0.0223, f1: 0.0201
step:  200 | loss: 78.257238 | [ENTITY] precision: 0.0229, recall: 0.0349, f1: 0.0277
step:  300 | loss: 54.370639 | [ENTITY] precision: 0.0297, recall: 0.0469, f1: 0.0364
step:  400 | loss: 42.062800 | [ENTITY] precision: 0.0370, recall: 0.0582, f1: 0.0453
step:  500 | loss: 34.536480 | [ENTITY] precision: 0.0463, recall: 0.0716, f1: 0.0562
step:  600 | loss: 29.463951 | [ENTITY] precision: 0.0550, recall: 0.0838, f1: 0.0664
step:  700 | loss: 25.755557 | [ENTITY] precision: 0.0636, recall: 0.0957, f1: 0.0764
step:  800 | loss: 22.902471 | [ENTITY] precision: 0.0720, recall: 0.1072, f1: 0.0862
step:  900 | loss: 20.618410 | [ENTITY] precision: 0.0805, recall: 0.1188, f1: 0.0960
step: 1000 | loss: 18.774264 | [ENTITY] precision: 0.0880, recall: 0.1289, f1: 0.1046
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1602, recall: 0.3888, f1: 0.2269
Best checkpoint
step: 1100 | loss: 1.811068 | [ENTITY] precision: 0.1689, recall: 0.2259, f1: 0.1933
step: 1200 | loss: 1.760278 | [ENTITY] precision: 0.1708, recall: 0.2306, f1: 0.1963
step: 1300 | loss: 1.662796 | [ENTITY] precision: 0.1818, recall: 0.2438, f1: 0.2083
step: 1400 | loss: 1.572605 | [ENTITY] precision: 0.1879, recall: 0.2523, f1: 0.2154
step: 1500 | loss: 1.488921 | [ENTITY] precision: 0.1987, recall: 0.2658, f1: 0.2274
step: 1600 | loss: 1.424081 | [ENTITY] precision: 0.2041, recall: 0.2723, f1: 0.2333
step: 1700 | loss: 1.372817 | [ENTITY] precision: 0.2090, recall: 0.2785, f1: 0.2388
step: 1800 | loss: 1.322091 | [ENTITY] precision: 0.2165, recall: 0.2877, f1: 0.2471
step: 1900 | loss: 1.273153 | [ENTITY] precision: 0.2214, recall: 0.2928, f1: 0.2522
step: 2000 | loss: 1.235698 | [ENTITY] precision: 0.2273, recall: 0.2993, f1: 0.2584
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1996, recall: 0.4187, f1: 0.2703
Best checkpoint
step: 2100 | loss: 0.836285 | [ENTITY] precision: 0.2947, recall: 0.3759, f1: 0.3303
step: 2200 | loss: 0.812715 | [ENTITY] precision: 0.2895, recall: 0.3676, f1: 0.3239
step: 2300 | loss: 0.792999 | [ENTITY] precision: 0.2954, recall: 0.3733, f1: 0.3298
step: 2400 | loss: 0.777159 | [ENTITY] precision: 0.2973, recall: 0.3753, f1: 0.3318
step: 2500 | loss: 0.752917 | [ENTITY] precision: 0.3006, recall: 0.3775, f1: 0.3347
step: 2600 | loss: 0.739057 | [ENTITY] precision: 0.3026, recall: 0.3789, f1: 0.3365
step: 2700 | loss: 0.725242 | [ENTITY] precision: 0.3078, recall: 0.3847, f1: 0.3420
step: 2800 | loss: 0.716193 | [ENTITY] precision: 0.3116, recall: 0.3879, f1: 0.3456
step: 2900 | loss: 0.707121 | [ENTITY] precision: 0.3151, recall: 0.3911, f1: 0.3490
step: 3000 | loss: 0.692912 | [ENTITY] precision: 0.3182, recall: 0.3946, f1: 0.3523
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2061, recall: 0.4225, f1: 0.2771
Best checkpoint
step: 3100 | loss: 0.568399 | [ENTITY] precision: 0.3558, recall: 0.4344, f1: 0.3912
step: 3200 | loss: 0.550364 | [ENTITY] precision: 0.3652, recall: 0.4412, f1: 0.3996
step: 3300 | loss: 0.544754 | [ENTITY] precision: 0.3725, recall: 0.4489, f1: 0.4072
step: 3400 | loss: 0.541678 | [ENTITY] precision: 0.3744, recall: 0.4506, f1: 0.4090
step: 3500 | loss: 0.549170 | [ENTITY] precision: 0.3764, recall: 0.4533, f1: 0.4113
step: 3600 | loss: 0.548667 | [ENTITY] precision: 0.3811, recall: 0.4584, f1: 0.4162
step: 3700 | loss: 0.540295 | [ENTITY] precision: 0.3833, recall: 0.4609, f1: 0.4185
step: 3800 | loss: 0.532699 | [ENTITY] precision: 0.3875, recall: 0.4645, f1: 0.4225
step: 3900 | loss: 0.523782 | [ENTITY] precision: 0.3904, recall: 0.4675, f1: 0.4254
step: 4000 | loss: 0.517972 | [ENTITY] precision: 0.3921, recall: 0.4687, f1: 0.4270
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2172, recall: 0.4085, f1: 0.2836
Best checkpoint
step: 4100 | loss: 0.423258 | [ENTITY] precision: 0.4312, recall: 0.5043, f1: 0.4649
step: 4200 | loss: 0.443898 | [ENTITY] precision: 0.4335, recall: 0.5042, f1: 0.4662
step: 4300 | loss: 0.429091 | [ENTITY] precision: 0.4454, recall: 0.5161, f1: 0.4781
step: 4400 | loss: 0.414603 | [ENTITY] precision: 0.4459, recall: 0.5173, f1: 0.4790
step: 4500 | loss: 0.407144 | [ENTITY] precision: 0.4498, recall: 0.5207, f1: 0.4826
step: 4600 | loss: 0.403138 | [ENTITY] precision: 0.4550, recall: 0.5255, f1: 0.4877
step: 4700 | loss: 0.400339 | [ENTITY] precision: 0.4562, recall: 0.5267, f1: 0.4889
step: 4800 | loss: 0.401280 | [ENTITY] precision: 0.4569, recall: 0.5280, f1: 0.4899
step: 4900 | loss: 0.398440 | [ENTITY] precision: 0.4601, recall: 0.5311, f1: 0.4930
step: 5000 | loss: 0.396319 | [ENTITY] precision: 0.4623, recall: 0.5334, f1: 0.4953
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2148, recall: 0.4119, f1: 0.2824
step: 5100 | loss: 0.361712 | [ENTITY] precision: 0.5065, recall: 0.5743, f1: 0.5383
step: 5200 | loss: 0.364886 | [ENTITY] precision: 0.4958, recall: 0.5652, f1: 0.5282
step: 5300 | loss: 0.360172 | [ENTITY] precision: 0.5022, recall: 0.5707, f1: 0.5343
step: 5400 | loss: 0.354391 | [ENTITY] precision: 0.5039, recall: 0.5730, f1: 0.5362
step: 5500 | loss: 0.346076 | [ENTITY] precision: 0.5067, recall: 0.5753, f1: 0.5388
step: 5600 | loss: 0.348206 | [ENTITY] precision: 0.5088, recall: 0.5781, f1: 0.5412
step: 5700 | loss: 0.346881 | [ENTITY] precision: 0.5103, recall: 0.5798, f1: 0.5429
step: 5800 | loss: 0.342172 | [ENTITY] precision: 0.5132, recall: 0.5826, f1: 0.5457
step: 5900 | loss: 0.339951 | [ENTITY] precision: 0.5138, recall: 0.5828, f1: 0.5462
step: 6000 | loss: 0.331713 | [ENTITY] precision: 0.5165, recall: 0.5851, f1: 0.5487
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2169, recall: 0.3949, f1: 0.2800
step: 6100 | loss: 0.284163 | [ENTITY] precision: 0.5460, recall: 0.6136, f1: 0.5778
step: 6200 | loss: 0.274733 | [ENTITY] precision: 0.5602, recall: 0.6261, f1: 0.5913
step: 6300 | loss: 0.272580 | [ENTITY] precision: 0.5602, recall: 0.6247, f1: 0.5907
step: 6400 | loss: 0.270467 | [ENTITY] precision: 0.5637, recall: 0.6261, f1: 0.5932
step: 6500 | loss: 0.269469 | [ENTITY] precision: 0.5648, recall: 0.6272, f1: 0.5944
step: 6600 | loss: 0.268802 | [ENTITY] precision: 0.5664, recall: 0.6298, f1: 0.5964
step: 6700 | loss: 0.269046 | [ENTITY] precision: 0.5674, recall: 0.6314, f1: 0.5977
step: 6800 | loss: 0.264758 | [ENTITY] precision: 0.5691, recall: 0.6327, f1: 0.5992
step: 6900 | loss: 0.264820 | [ENTITY] precision: 0.5699, recall: 0.6337, f1: 0.6001
step: 7000 | loss: 0.260614 | [ENTITY] precision: 0.5737, recall: 0.6362, f1: 0.6033
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2243, recall: 0.4007, f1: 0.2876
Best checkpoint
step: 7100 | loss: 0.241882 | [ENTITY] precision: 0.5878, recall: 0.6575, f1: 0.6207
step: 7200 | loss: 0.226670 | [ENTITY] precision: 0.5977, recall: 0.6643, f1: 0.6293
step: 7300 | loss: 0.219106 | [ENTITY] precision: 0.5997, recall: 0.6636, f1: 0.6300
step: 7400 | loss: 0.222376 | [ENTITY] precision: 0.6025, recall: 0.6658, f1: 0.6326
step: 7500 | loss: 0.220075 | [ENTITY] precision: 0.6061, recall: 0.6694, f1: 0.6362
step: 7600 | loss: 0.217487 | [ENTITY] precision: 0.6067, recall: 0.6695, f1: 0.6365
step: 7700 | loss: 0.215776 | [ENTITY] precision: 0.6089, recall: 0.6704, f1: 0.6382
step: 7800 | loss: 0.214490 | [ENTITY] precision: 0.6101, recall: 0.6710, f1: 0.6391
step: 7900 | loss: 0.213550 | [ENTITY] precision: 0.6125, recall: 0.6727, f1: 0.6412
step: 8000 | loss: 0.213345 | [ENTITY] precision: 0.6149, recall: 0.6749, f1: 0.6435
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2207, recall: 0.3950, f1: 0.2832
step: 8100 | loss: 0.220782 | [ENTITY] precision: 0.6334, recall: 0.6941, f1: 0.6624
step: 8200 | loss: 0.215677 | [ENTITY] precision: 0.6281, recall: 0.6904, f1: 0.6578
step: 8300 | loss: 0.214173 | [ENTITY] precision: 0.6325, recall: 0.6910, f1: 0.6604
step: 8400 | loss: 0.209036 | [ENTITY] precision: 0.6350, recall: 0.6948, f1: 0.6636
step: 8500 | loss: 0.203692 | [ENTITY] precision: 0.6377, recall: 0.6983, f1: 0.6667
step: 8600 | loss: 0.200288 | [ENTITY] precision: 0.6407, recall: 0.7006, f1: 0.6693
step: 8700 | loss: 0.197470 | [ENTITY] precision: 0.6418, recall: 0.7011, f1: 0.6701
step: 8800 | loss: 0.197519 | [ENTITY] precision: 0.6423, recall: 0.7018, f1: 0.6707
step: 8900 | loss: 0.193700 | [ENTITY] precision: 0.6443, recall: 0.7032, f1: 0.6725
step: 9000 | loss: 0.190997 | [ENTITY] precision: 0.6467, recall: 0.7055, f1: 0.6748
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2353, recall: 0.4097, f1: 0.2989
Best checkpoint
step: 9100 | loss: 0.160918 | [ENTITY] precision: 0.6714, recall: 0.7271, f1: 0.6981
step: 9200 | loss: 0.163693 | [ENTITY] precision: 0.6706, recall: 0.7246, f1: 0.6965
step: 9300 | loss: 0.168675 | [ENTITY] precision: 0.6711, recall: 0.7257, f1: 0.6973
step: 9400 | loss: 0.165342 | [ENTITY] precision: 0.6730, recall: 0.7267, f1: 0.6988
step: 9500 | loss: 0.163444 | [ENTITY] precision: 0.6736, recall: 0.7282, f1: 0.6998
step: 9600 | loss: 0.163152 | [ENTITY] precision: 0.6750, recall: 0.7293, f1: 0.7011
step: 9700 | loss: 0.164460 | [ENTITY] precision: 0.6754, recall: 0.7299, f1: 0.7016
step: 9800 | loss: 0.164598 | [ENTITY] precision: 0.6765, recall: 0.7311, f1: 0.7028
step: 9900 | loss: 0.162377 | [ENTITY] precision: 0.6778, recall: 0.7325, f1: 0.7041
step: 10000 | loss: 0.161164 | [ENTITY] precision: 0.6788, recall: 0.7335, f1: 0.7051
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2330, recall: 0.4051, f1: 0.2958

####################

Finish training proto-inter-5-1-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/proto-inter-5-1-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.3235, recall: 0.5100, f1: 0.3959
RESULT: precision: 0.3235, recall: 0.5100, f1:0.3959
ERROR ANALYSIS: fp: 0.0638, fn: 0.0138, within:0.0703, outer: 0.1478
------------------------
5-way-5-shot 
model: proto
max_length: 32
mode: inter
loading model and tokenizer...
loading data...
use proto
model-save-path: checkpoint/proto-inter-5-5-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 44.082189 | [ENTITY] precision: 0.1405, recall: 0.2038, f1: 0.1663
step:  200 | loss: 24.771956 | [ENTITY] precision: 0.1330, recall: 0.2112, f1: 0.1632
step:  300 | loss: 17.573401 | [ENTITY] precision: 0.1441, recall: 0.2281, f1: 0.1766
step:  400 | loss: 13.765851 | [ENTITY] precision: 0.1558, recall: 0.2469, f1: 0.1910
step:  500 | loss: 11.391569 | [ENTITY] precision: 0.1653, recall: 0.2586, f1: 0.2017
step:  600 | loss: 9.731629 | [ENTITY] precision: 0.1738, recall: 0.2697, f1: 0.2114
step:  700 | loss: 8.530870 | [ENTITY] precision: 0.1807, recall: 0.2763, f1: 0.2185
step:  800 | loss: 7.585312 | [ENTITY] precision: 0.1883, recall: 0.2852, f1: 0.2268
step:  900 | loss: 6.841289 | [ENTITY] precision: 0.1972, recall: 0.2939, f1: 0.2360
step: 1000 | loss: 6.244845 | [ENTITY] precision: 0.2028, recall: 0.3006, f1: 0.2422
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2969, recall: 0.5140, f1: 0.3764
Best checkpoint
step: 1100 | loss: 0.740324 | [ENTITY] precision: 0.2821, recall: 0.3792, f1: 0.3235
step: 1200 | loss: 0.746202 | [ENTITY] precision: 0.2755, recall: 0.3712, f1: 0.3163
step: 1300 | loss: 0.712304 | [ENTITY] precision: 0.2815, recall: 0.3766, f1: 0.3222
step: 1400 | loss: 0.680875 | [ENTITY] precision: 0.2911, recall: 0.3865, f1: 0.3321
step: 1500 | loss: 0.665381 | [ENTITY] precision: 0.2939, recall: 0.3889, f1: 0.3348
step: 1600 | loss: 0.644257 | [ENTITY] precision: 0.3006, recall: 0.3964, f1: 0.3419
step: 1700 | loss: 0.629013 | [ENTITY] precision: 0.3035, recall: 0.4003, f1: 0.3453
step: 1800 | loss: 0.608362 | [ENTITY] precision: 0.3062, recall: 0.4037, f1: 0.3483
step: 1900 | loss: 0.590173 | [ENTITY] precision: 0.3125, recall: 0.4102, f1: 0.3547
step: 2000 | loss: 0.577106 | [ENTITY] precision: 0.3164, recall: 0.4149, f1: 0.3590
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3322, recall: 0.5385, f1: 0.4109
Best checkpoint
step: 2100 | loss: 0.450631 | [ENTITY] precision: 0.3405, recall: 0.4477, f1: 0.3868
step: 2200 | loss: 0.448275 | [ENTITY] precision: 0.3620, recall: 0.4637, f1: 0.4066
step: 2300 | loss: 0.438300 | [ENTITY] precision: 0.3603, recall: 0.4624, f1: 0.4050
step: 2400 | loss: 0.429858 | [ENTITY] precision: 0.3643, recall: 0.4671, f1: 0.4094
step: 2500 | loss: 0.420862 | [ENTITY] precision: 0.3673, recall: 0.4714, f1: 0.4129
step: 2600 | loss: 0.412852 | [ENTITY] precision: 0.3740, recall: 0.4778, f1: 0.4196
step: 2700 | loss: 0.406671 | [ENTITY] precision: 0.3779, recall: 0.4799, f1: 0.4228
step: 2800 | loss: 0.402775 | [ENTITY] precision: 0.3828, recall: 0.4849, f1: 0.4278
step: 2900 | loss: 0.398316 | [ENTITY] precision: 0.3856, recall: 0.4867, f1: 0.4303
step: 3000 | loss: 0.391504 | [ENTITY] precision: 0.3898, recall: 0.4912, f1: 0.4346
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3650, recall: 0.5913, f1: 0.4513
Best checkpoint
step: 3100 | loss: 0.369230 | [ENTITY] precision: 0.4072, recall: 0.5029, f1: 0.4501
step: 3200 | loss: 0.364361 | [ENTITY] precision: 0.4054, recall: 0.5028, f1: 0.4489
step: 3300 | loss: 0.350669 | [ENTITY] precision: 0.4130, recall: 0.5090, f1: 0.4560
step: 3400 | loss: 0.346061 | [ENTITY] precision: 0.4118, recall: 0.5087, f1: 0.4552
step: 3500 | loss: 0.343258 | [ENTITY] precision: 0.4178, recall: 0.5157, f1: 0.4616
step: 3600 | loss: 0.340256 | [ENTITY] precision: 0.4186, recall: 0.5173, f1: 0.4627
step: 3700 | loss: 0.337117 | [ENTITY] precision: 0.4214, recall: 0.5196, f1: 0.4653
step: 3800 | loss: 0.329962 | [ENTITY] precision: 0.4263, recall: 0.5234, f1: 0.4699
step: 3900 | loss: 0.326477 | [ENTITY] precision: 0.4302, recall: 0.5280, f1: 0.4741
step: 4000 | loss: 0.320416 | [ENTITY] precision: 0.4341, recall: 0.5306, f1: 0.4775
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3680, recall: 0.5869, f1: 0.4523
Best checkpoint
step: 4100 | loss: 0.298633 | [ENTITY] precision: 0.4540, recall: 0.5568, f1: 0.5002
step: 4200 | loss: 0.285434 | [ENTITY] precision: 0.4694, recall: 0.5683, f1: 0.5142
step: 4300 | loss: 0.283229 | [ENTITY] precision: 0.4715, recall: 0.5666, f1: 0.5147
step: 4400 | loss: 0.279913 | [ENTITY] precision: 0.4725, recall: 0.5684, f1: 0.5160
step: 4500 | loss: 0.283843 | [ENTITY] precision: 0.4692, recall: 0.5638, f1: 0.5122
step: 4600 | loss: 0.280674 | [ENTITY] precision: 0.4725, recall: 0.5667, f1: 0.5153
step: 4700 | loss: 0.277815 | [ENTITY] precision: 0.4754, recall: 0.5697, f1: 0.5183
step: 4800 | loss: 0.274910 | [ENTITY] precision: 0.4760, recall: 0.5689, f1: 0.5183
step: 4900 | loss: 0.271423 | [ENTITY] precision: 0.4807, recall: 0.5723, f1: 0.5225
step: 5000 | loss: 0.270821 | [ENTITY] precision: 0.4831, recall: 0.5742, f1: 0.5247
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3662, recall: 0.5920, f1: 0.4525
Best checkpoint
step: 5100 | loss: 0.249719 | [ENTITY] precision: 0.4876, recall: 0.5928, f1: 0.5351
step: 5200 | loss: 0.248562 | [ENTITY] precision: 0.4984, recall: 0.5925, f1: 0.5414
step: 5300 | loss: 0.246992 | [ENTITY] precision: 0.5009, recall: 0.5933, f1: 0.5432
step: 5400 | loss: 0.243757 | [ENTITY] precision: 0.5047, recall: 0.5965, f1: 0.5468
step: 5500 | loss: 0.240812 | [ENTITY] precision: 0.5091, recall: 0.5998, f1: 0.5508
step: 5600 | loss: 0.241157 | [ENTITY] precision: 0.5113, recall: 0.5997, f1: 0.5520
step: 5700 | loss: 0.241269 | [ENTITY] precision: 0.5103, recall: 0.5996, f1: 0.5513
step: 5800 | loss: 0.237255 | [ENTITY] precision: 0.5142, recall: 0.6017, f1: 0.5545
step: 5900 | loss: 0.234861 | [ENTITY] precision: 0.5172, recall: 0.6038, f1: 0.5571
step: 6000 | loss: 0.232605 | [ENTITY] precision: 0.5193, recall: 0.6055, f1: 0.5591
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3829, recall: 0.5884, f1: 0.4639
Best checkpoint
step: 6100 | loss: 0.220849 | [ENTITY] precision: 0.5305, recall: 0.6121, f1: 0.5684
step: 6200 | loss: 0.224049 | [ENTITY] precision: 0.5390, recall: 0.6117, f1: 0.5731
step: 6300 | loss: 0.222500 | [ENTITY] precision: 0.5349, recall: 0.6154, f1: 0.5724
step: 6400 | loss: 0.221033 | [ENTITY] precision: 0.5331, recall: 0.6136, f1: 0.5705
step: 6500 | loss: 0.215972 | [ENTITY] precision: 0.5412, recall: 0.6212, f1: 0.5784
step: 6600 | loss: 0.213312 | [ENTITY] precision: 0.5422, recall: 0.6227, f1: 0.5797
step: 6700 | loss: 0.211725 | [ENTITY] precision: 0.5461, recall: 0.6267, f1: 0.5836
step: 6800 | loss: 0.209301 | [ENTITY] precision: 0.5503, recall: 0.6303, f1: 0.5876
step: 6900 | loss: 0.207301 | [ENTITY] precision: 0.5540, recall: 0.6335, f1: 0.5911
step: 7000 | loss: 0.205519 | [ENTITY] precision: 0.5559, recall: 0.6356, f1: 0.5931
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3916, recall: 0.5818, f1: 0.4681
Best checkpoint
step: 7100 | loss: 0.190274 | [ENTITY] precision: 0.5774, recall: 0.6606, f1: 0.6162
step: 7200 | loss: 0.179793 | [ENTITY] precision: 0.5974, recall: 0.6748, f1: 0.6338
step: 7300 | loss: 0.177536 | [ENTITY] precision: 0.5949, recall: 0.6749, f1: 0.6324
step: 7400 | loss: 0.174688 | [ENTITY] precision: 0.6007, recall: 0.6794, f1: 0.6376
step: 7500 | loss: 0.180398 | [ENTITY] precision: 0.5940, recall: 0.6727, f1: 0.6309
step: 7600 | loss: 0.176804 | [ENTITY] precision: 0.5958, recall: 0.6739, f1: 0.6324
step: 7700 | loss: 0.175669 | [ENTITY] precision: 0.5961, recall: 0.6754, f1: 0.6333
step: 7800 | loss: 0.178350 | [ENTITY] precision: 0.5964, recall: 0.6756, f1: 0.6335
step: 7900 | loss: 0.175703 | [ENTITY] precision: 0.5994, recall: 0.6788, f1: 0.6366
step: 8000 | loss: 0.173731 | [ENTITY] precision: 0.6010, recall: 0.6792, f1: 0.6377
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3742, recall: 0.5632, f1: 0.4497
step: 8100 | loss: 0.176030 | [ENTITY] precision: 0.6089, recall: 0.6762, f1: 0.6408
step: 8200 | loss: 0.166364 | [ENTITY] precision: 0.6201, recall: 0.6892, f1: 0.6529
step: 8300 | loss: 0.163524 | [ENTITY] precision: 0.6182, recall: 0.6878, f1: 0.6511
step: 8400 | loss: 0.162365 | [ENTITY] precision: 0.6188, recall: 0.6894, f1: 0.6522
step: 8500 | loss: 0.159562 | [ENTITY] precision: 0.6238, recall: 0.6926, f1: 0.6564
step: 8600 | loss: 0.158175 | [ENTITY] precision: 0.6230, recall: 0.6933, f1: 0.6563
step: 8700 | loss: 0.157918 | [ENTITY] precision: 0.6234, recall: 0.6933, f1: 0.6565
step: 8800 | loss: 0.157724 | [ENTITY] precision: 0.6260, recall: 0.6949, f1: 0.6587
step: 8900 | loss: 0.156640 | [ENTITY] precision: 0.6253, recall: 0.6957, f1: 0.6586
step: 9000 | loss: 0.155450 | [ENTITY] precision: 0.6270, recall: 0.6972, f1: 0.6603
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3805, recall: 0.5746, f1: 0.4578
step: 9100 | loss: 0.153968 | [ENTITY] precision: 0.6158, recall: 0.6894, f1: 0.6505
step: 9200 | loss: 0.149443 | [ENTITY] precision: 0.6228, recall: 0.7045, f1: 0.6611
step: 9300 | loss: 0.147314 | [ENTITY] precision: 0.6325, recall: 0.7082, f1: 0.6682
step: 9400 | loss: 0.145453 | [ENTITY] precision: 0.6376, recall: 0.7121, f1: 0.6728
step: 9500 | loss: 0.141966 | [ENTITY] precision: 0.6460, recall: 0.7183, f1: 0.6802
step: 9600 | loss: 0.138815 | [ENTITY] precision: 0.6498, recall: 0.7242, f1: 0.6850
step: 9700 | loss: 0.137537 | [ENTITY] precision: 0.6512, recall: 0.7247, f1: 0.6860
step: 9800 | loss: 0.138068 | [ENTITY] precision: 0.6508, recall: 0.7251, f1: 0.6860
step: 9900 | loss: 0.138623 | [ENTITY] precision: 0.6507, recall: 0.7256, f1: 0.6861
step: 10000 | loss: 0.138100 | [ENTITY] precision: 0.6523, recall: 0.7254, f1: 0.6869
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3927, recall: 0.5766, f1: 0.4672

####################

Finish training proto-inter-5-5-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/proto-inter-5-5-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.5102, recall: 0.6555, f1: 0.5738
RESULT: precision: 0.5102, recall: 0.6555, f1:0.5738
ERROR ANALYSIS: fp: 0.0554, fn: 0.0109, within:0.0375, outer: 0.0497
------------------------
10-way-1-shot 
model: proto
max_length: 64
mode: inter
loading model and tokenizer...
loading data...
use proto
model-save-path: checkpoint/proto-inter-10-1-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 179.385324 | [ENTITY] precision: 0.0112, recall: 0.0131, f1: 0.0121
step:  200 | loss: 99.510057 | [ENTITY] precision: 0.0137, recall: 0.0197, f1: 0.0161
step:  300 | loss: 70.497378 | [ENTITY] precision: 0.0170, recall: 0.0270, f1: 0.0209
step:  400 | loss: 55.174867 | [ENTITY] precision: 0.0218, recall: 0.0352, f1: 0.0269
step:  500 | loss: 45.496167 | [ENTITY] precision: 0.0291, recall: 0.0473, f1: 0.0360
step:  600 | loss: 38.855303 | [ENTITY] precision: 0.0315, recall: 0.0509, f1: 0.0389
step:  700 | loss: 33.957730 | [ENTITY] precision: 0.0348, recall: 0.0563, f1: 0.0430
step:  800 | loss: 30.222109 | [ENTITY] precision: 0.0372, recall: 0.0598, f1: 0.0459
step:  900 | loss: 27.258323 | [ENTITY] precision: 0.0395, recall: 0.0632, f1: 0.0486
step: 1000 | loss: 24.881081 | [ENTITY] precision: 0.0421, recall: 0.0669, f1: 0.0517
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.0955, recall: 0.2847, f1: 0.1430
Best checkpoint
step: 1100 | loss: 2.875906 | [ENTITY] precision: 0.0690, recall: 0.1043, f1: 0.0831
step: 1200 | loss: 2.792356 | [ENTITY] precision: 0.0664, recall: 0.1004, f1: 0.0800
step: 1300 | loss: 2.599116 | [ENTITY] precision: 0.0648, recall: 0.0986, f1: 0.0782
step: 1400 | loss: 2.512593 | [ENTITY] precision: 0.0697, recall: 0.1057, f1: 0.0840
step: 1500 | loss: 2.446795 | [ENTITY] precision: 0.0748, recall: 0.1141, f1: 0.0903
step: 1600 | loss: 2.476215 | [ENTITY] precision: 0.0776, recall: 0.1185, f1: 0.0938
step: 1700 | loss: 2.383131 | [ENTITY] precision: 0.0788, recall: 0.1194, f1: 0.0949
step: 1800 | loss: 2.303790 | [ENTITY] precision: 0.0813, recall: 0.1228, f1: 0.0978
step: 1900 | loss: 2.235709 | [ENTITY] precision: 0.0841, recall: 0.1267, f1: 0.1011
step: 2000 | loss: 2.203612 | [ENTITY] precision: 0.0859, recall: 0.1288, f1: 0.1031
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1179, recall: 0.3198, f1: 0.1723
Best checkpoint
step: 2100 | loss: 1.551154 | [ENTITY] precision: 0.1113, recall: 0.1624, f1: 0.1321
step: 2200 | loss: 1.470368 | [ENTITY] precision: 0.1102, recall: 0.1603, f1: 0.1307
step: 2300 | loss: 1.459802 | [ENTITY] precision: 0.1102, recall: 0.1600, f1: 0.1305
step: 2400 | loss: 1.449242 | [ENTITY] precision: 0.1129, recall: 0.1639, f1: 0.1337
step: 2500 | loss: 1.426040 | [ENTITY] precision: 0.1151, recall: 0.1666, f1: 0.1362
step: 2600 | loss: 1.434264 | [ENTITY] precision: 0.1195, recall: 0.1718, f1: 0.1409
step: 2700 | loss: 1.446021 | [ENTITY] precision: 0.1223, recall: 0.1749, f1: 0.1440
step: 2800 | loss: 1.425661 | [ENTITY] precision: 0.1250, recall: 0.1783, f1: 0.1470
step: 2900 | loss: 1.414734 | [ENTITY] precision: 0.1272, recall: 0.1815, f1: 0.1496
step: 3000 | loss: 1.416065 | [ENTITY] precision: 0.1289, recall: 0.1837, f1: 0.1515
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1254, recall: 0.3024, f1: 0.1772
Best checkpoint
step: 3100 | loss: 1.225671 | [ENTITY] precision: 0.1600, recall: 0.2180, f1: 0.1845
step: 3200 | loss: 1.269842 | [ENTITY] precision: 0.1585, recall: 0.2193, f1: 0.1840
step: 3300 | loss: 1.244220 | [ENTITY] precision: 0.1574, recall: 0.2198, f1: 0.1834
step: 3400 | loss: 1.259215 | [ENTITY] precision: 0.1619, recall: 0.2241, f1: 0.1880
step: 3500 | loss: 1.215782 | [ENTITY] precision: 0.1636, recall: 0.2263, f1: 0.1899
step: 3600 | loss: 1.198279 | [ENTITY] precision: 0.1655, recall: 0.2277, f1: 0.1917
step: 3700 | loss: 1.169701 | [ENTITY] precision: 0.1699, recall: 0.2325, f1: 0.1963
step: 3800 | loss: 1.161115 | [ENTITY] precision: 0.1689, recall: 0.2306, f1: 0.1950
step: 3900 | loss: 1.139356 | [ENTITY] precision: 0.1720, recall: 0.2344, f1: 0.1984
step: 4000 | loss: 1.133539 | [ENTITY] precision: 0.1749, recall: 0.2372, f1: 0.2013
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1425, recall: 0.3374, f1: 0.2004
Best checkpoint
step: 4100 | loss: 1.160057 | [ENTITY] precision: 0.2041, recall: 0.2802, f1: 0.2361
step: 4200 | loss: 1.024956 | [ENTITY] precision: 0.2144, recall: 0.2856, f1: 0.2449
step: 4300 | loss: 0.981015 | [ENTITY] precision: 0.2043, recall: 0.2746, f1: 0.2343
step: 4400 | loss: 1.056478 | [ENTITY] precision: 0.2088, recall: 0.2790, f1: 0.2388
step: 4500 | loss: 1.014928 | [ENTITY] precision: 0.2091, recall: 0.2778, f1: 0.2386
step: 4600 | loss: 1.018245 | [ENTITY] precision: 0.2069, recall: 0.2742, f1: 0.2358
step: 4700 | loss: 1.007734 | [ENTITY] precision: 0.2092, recall: 0.2762, f1: 0.2381
step: 4800 | loss: 0.998409 | [ENTITY] precision: 0.2122, recall: 0.2791, f1: 0.2411
step: 4900 | loss: 0.986965 | [ENTITY] precision: 0.2170, recall: 0.2835, f1: 0.2458
step: 5000 | loss: 0.955368 | [ENTITY] precision: 0.2216, recall: 0.2881, f1: 0.2505
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1476, recall: 0.3261, f1: 0.2032
Best checkpoint
step: 5100 | loss: 1.056645 | [ENTITY] precision: 0.2321, recall: 0.3016, f1: 0.2623
step: 5200 | loss: 1.029600 | [ENTITY] precision: 0.2420, recall: 0.3168, f1: 0.2744
step: 5300 | loss: 0.944120 | [ENTITY] precision: 0.2411, recall: 0.3132, f1: 0.2725
step: 5400 | loss: 0.920649 | [ENTITY] precision: 0.2484, recall: 0.3211, f1: 0.2801
step: 5500 | loss: 0.909845 | [ENTITY] precision: 0.2525, recall: 0.3229, f1: 0.2834
step: 5600 | loss: 0.884382 | [ENTITY] precision: 0.2565, recall: 0.3258, f1: 0.2870
step: 5700 | loss: 0.884727 | [ENTITY] precision: 0.2597, recall: 0.3299, f1: 0.2906
step: 5800 | loss: 0.875496 | [ENTITY] precision: 0.2626, recall: 0.3314, f1: 0.2930
step: 5900 | loss: 0.844968 | [ENTITY] precision: 0.2657, recall: 0.3347, f1: 0.2963
step: 6000 | loss: 0.826993 | [ENTITY] precision: 0.2692, recall: 0.3378, f1: 0.2996
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1517, recall: 0.3236, f1: 0.2066
Best checkpoint
step: 6100 | loss: 0.776285 | [ENTITY] precision: 0.2732, recall: 0.3364, f1: 0.3015
step: 6200 | loss: 0.786947 | [ENTITY] precision: 0.2779, recall: 0.3435, f1: 0.3072
step: 6300 | loss: 0.784501 | [ENTITY] precision: 0.2781, recall: 0.3429, f1: 0.3071
step: 6400 | loss: 0.754788 | [ENTITY] precision: 0.2857, recall: 0.3513, f1: 0.3151
step: 6500 | loss: 0.753440 | [ENTITY] precision: 0.2847, recall: 0.3484, f1: 0.3134
step: 6600 | loss: 0.717579 | [ENTITY] precision: 0.2895, recall: 0.3530, f1: 0.3181
step: 6700 | loss: 0.695084 | [ENTITY] precision: 0.2938, recall: 0.3581, f1: 0.3228
step: 6800 | loss: 0.671364 | [ENTITY] precision: 0.2974, recall: 0.3624, f1: 0.3267
step: 6900 | loss: 0.686219 | [ENTITY] precision: 0.2989, recall: 0.3642, f1: 0.3283
step: 7000 | loss: 0.679511 | [ENTITY] precision: 0.3030, recall: 0.3686, f1: 0.3326
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1598, recall: 0.3141, f1: 0.2118
Best checkpoint
step: 7100 | loss: 0.546309 | [ENTITY] precision: 0.3386, recall: 0.4129, f1: 0.3721
step: 7200 | loss: 0.531401 | [ENTITY] precision: 0.3472, recall: 0.4161, f1: 0.3785
step: 7300 | loss: 0.594228 | [ENTITY] precision: 0.3422, recall: 0.4074, f1: 0.3720
step: 7400 | loss: 0.587782 | [ENTITY] precision: 0.3428, recall: 0.4066, f1: 0.3719
step: 7500 | loss: 0.596127 | [ENTITY] precision: 0.3457, recall: 0.4092, f1: 0.3748
step: 7600 | loss: 0.595390 | [ENTITY] precision: 0.3480, recall: 0.4116, f1: 0.3771
step: 7700 | loss: 0.589959 | [ENTITY] precision: 0.3518, recall: 0.4146, f1: 0.3806
step: 7800 | loss: 0.592893 | [ENTITY] precision: 0.3499, recall: 0.4128, f1: 0.3788
step: 7900 | loss: 0.584030 | [ENTITY] precision: 0.3500, recall: 0.4132, f1: 0.3790
step: 8000 | loss: 0.572903 | [ENTITY] precision: 0.3501, recall: 0.4144, f1: 0.3795
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1532, recall: 0.3177, f1: 0.2068
step: 8100 | loss: 0.417249 | [ENTITY] precision: 0.3685, recall: 0.4290, f1: 0.3965
step: 8200 | loss: 0.442368 | [ENTITY] precision: 0.3805, recall: 0.4422, f1: 0.4090
step: 8300 | loss: 0.437475 | [ENTITY] precision: 0.3841, recall: 0.4475, f1: 0.4134
step: 8400 | loss: 0.412442 | [ENTITY] precision: 0.3911, recall: 0.4548, f1: 0.4205
step: 8500 | loss: 0.432137 | [ENTITY] precision: 0.3917, recall: 0.4571, f1: 0.4219
step: 8600 | loss: 0.439192 | [ENTITY] precision: 0.3884, recall: 0.4551, f1: 0.4192
step: 8700 | loss: 0.458249 | [ENTITY] precision: 0.3892, recall: 0.4577, f1: 0.4206
step: 8800 | loss: 0.445632 | [ENTITY] precision: 0.3935, recall: 0.4623, f1: 0.4251
step: 8900 | loss: 0.457716 | [ENTITY] precision: 0.3974, recall: 0.4654, f1: 0.4287
step: 9000 | loss: 0.463253 | [ENTITY] precision: 0.3993, recall: 0.4678, f1: 0.4308
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1717, recall: 0.3248, f1: 0.2246
Best checkpoint
step: 9100 | loss: 0.510419 | [ENTITY] precision: 0.4091, recall: 0.4715, f1: 0.4381
step: 9200 | loss: 0.447944 | [ENTITY] precision: 0.4072, recall: 0.4711, f1: 0.4368
step: 9300 | loss: 0.441934 | [ENTITY] precision: 0.4186, recall: 0.4882, f1: 0.4508
step: 9400 | loss: 0.436415 | [ENTITY] precision: 0.4266, recall: 0.4963, f1: 0.4588
step: 9500 | loss: 0.420974 | [ENTITY] precision: 0.4233, recall: 0.4939, f1: 0.4559
step: 9600 | loss: 0.422484 | [ENTITY] precision: 0.4245, recall: 0.4953, f1: 0.4572
step: 9700 | loss: 0.424959 | [ENTITY] precision: 0.4227, recall: 0.4954, f1: 0.4562
step: 9800 | loss: 0.432367 | [ENTITY] precision: 0.4247, recall: 0.4970, f1: 0.4580
step: 9900 | loss: 0.442129 | [ENTITY] precision: 0.4245, recall: 0.4973, f1: 0.4580
step: 10000 | loss: 0.437103 | [ENTITY] precision: 0.4247, recall: 0.4979, f1: 0.4584
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1799, recall: 0.3304, f1: 0.2330
Best checkpoint

####################

Finish training proto-inter-10-1-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/proto-inter-10-1-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.2792, recall: 0.4526, f1: 0.3454
RESULT: precision: 0.2792, recall: 0.4526, f1:0.3454
ERROR ANALYSIS: fp: 0.0632, fn: 0.0136, within:0.1334, outer: 0.1675
------------------------
10-way-5-shot 
model: proto
max_length: 32
mode: inter
loading model and tokenizer...
loading data...
use proto
model-save-path: checkpoint/proto-inter-10-5-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 49.199766 | [ENTITY] precision: 0.0814, recall: 0.1435, f1: 0.1039
step:  200 | loss: 28.225252 | [ENTITY] precision: 0.0754, recall: 0.1360, f1: 0.0970
step:  300 | loss: 20.151053 | [ENTITY] precision: 0.0812, recall: 0.1478, f1: 0.1048
step:  400 | loss: 15.845140 | [ENTITY] precision: 0.0895, recall: 0.1634, f1: 0.1156
step:  500 | loss: 13.165298 | [ENTITY] precision: 0.0938, recall: 0.1691, f1: 0.1206
step:  600 | loss: 11.278362 | [ENTITY] precision: 0.0985, recall: 0.1750, f1: 0.1261
step:  700 | loss: 9.875638 | [ENTITY] precision: 0.1047, recall: 0.1835, f1: 0.1333
step:  800 | loss: 8.798007 | [ENTITY] precision: 0.1110, recall: 0.1914, f1: 0.1405
step:  900 | loss: 7.947429 | [ENTITY] precision: 0.1163, recall: 0.1989, f1: 0.1468
step: 1000 | loss: 7.255914 | [ENTITY] precision: 0.1211, recall: 0.2043, f1: 0.1521
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2132, recall: 0.4347, f1: 0.2861
Best checkpoint
step: 1100 | loss: 0.862858 | [ENTITY] precision: 0.1785, recall: 0.2746, f1: 0.2163
step: 1200 | loss: 0.818115 | [ENTITY] precision: 0.1886, recall: 0.2847, f1: 0.2269
step: 1300 | loss: 0.800475 | [ENTITY] precision: 0.1903, recall: 0.2859, f1: 0.2285
step: 1400 | loss: 0.780258 | [ENTITY] precision: 0.1918, recall: 0.2871, f1: 0.2300
step: 1500 | loss: 0.751584 | [ENTITY] precision: 0.1959, recall: 0.2916, f1: 0.2344
step: 1600 | loss: 0.727255 | [ENTITY] precision: 0.2003, recall: 0.2968, f1: 0.2392
step: 1700 | loss: 0.715698 | [ENTITY] precision: 0.2052, recall: 0.3027, f1: 0.2446
step: 1800 | loss: 0.702483 | [ENTITY] precision: 0.2099, recall: 0.3079, f1: 0.2497
step: 1900 | loss: 0.686451 | [ENTITY] precision: 0.2127, recall: 0.3101, f1: 0.2523
step: 2000 | loss: 0.672658 | [ENTITY] precision: 0.2169, recall: 0.3158, f1: 0.2572
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2544, recall: 0.4917, f1: 0.3353
Best checkpoint
step: 2100 | loss: 0.521905 | [ENTITY] precision: 0.2514, recall: 0.3579, f1: 0.2953
step: 2200 | loss: 0.522891 | [ENTITY] precision: 0.2659, recall: 0.3729, f1: 0.3104
step: 2300 | loss: 0.513560 | [ENTITY] precision: 0.2618, recall: 0.3669, f1: 0.3055
step: 2400 | loss: 0.499793 | [ENTITY] precision: 0.2637, recall: 0.3714, f1: 0.3084
step: 2500 | loss: 0.500479 | [ENTITY] precision: 0.2644, recall: 0.3697, f1: 0.3083
step: 2600 | loss: 0.491153 | [ENTITY] precision: 0.2677, recall: 0.3740, f1: 0.3120
step: 2700 | loss: 0.491308 | [ENTITY] precision: 0.2702, recall: 0.3760, f1: 0.3144
step: 2800 | loss: 0.482850 | [ENTITY] precision: 0.2723, recall: 0.3770, f1: 0.3162
step: 2900 | loss: 0.477870 | [ENTITY] precision: 0.2731, recall: 0.3766, f1: 0.3166
step: 3000 | loss: 0.475512 | [ENTITY] precision: 0.2761, recall: 0.3785, f1: 0.3193
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2701, recall: 0.4992, f1: 0.3505
Best checkpoint
step: 3100 | loss: 0.424476 | [ENTITY] precision: 0.2847, recall: 0.3915, f1: 0.3297
step: 3200 | loss: 0.409867 | [ENTITY] precision: 0.3015, recall: 0.4049, f1: 0.3456
step: 3300 | loss: 0.407116 | [ENTITY] precision: 0.3037, recall: 0.4069, f1: 0.3478
step: 3400 | loss: 0.402297 | [ENTITY] precision: 0.3079, recall: 0.4126, f1: 0.3526
step: 3500 | loss: 0.400576 | [ENTITY] precision: 0.3129, recall: 0.4180, f1: 0.3579
step: 3600 | loss: 0.401301 | [ENTITY] precision: 0.3155, recall: 0.4210, f1: 0.3607
step: 3700 | loss: 0.397365 | [ENTITY] precision: 0.3190, recall: 0.4225, f1: 0.3635
step: 3800 | loss: 0.396370 | [ENTITY] precision: 0.3194, recall: 0.4232, f1: 0.3641
step: 3900 | loss: 0.394421 | [ENTITY] precision: 0.3233, recall: 0.4265, f1: 0.3678
step: 4000 | loss: 0.391855 | [ENTITY] precision: 0.3234, recall: 0.4266, f1: 0.3679
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2662, recall: 0.4802, f1: 0.3425
step: 4100 | loss: 0.347392 | [ENTITY] precision: 0.3261, recall: 0.4286, f1: 0.3704
step: 4200 | loss: 0.338798 | [ENTITY] precision: 0.3457, recall: 0.4413, f1: 0.3877
step: 4300 | loss: 0.341675 | [ENTITY] precision: 0.3427, recall: 0.4398, f1: 0.3853
step: 4400 | loss: 0.336144 | [ENTITY] precision: 0.3468, recall: 0.4471, f1: 0.3906
step: 4500 | loss: 0.335275 | [ENTITY] precision: 0.3475, recall: 0.4486, f1: 0.3916
step: 4600 | loss: 0.329069 | [ENTITY] precision: 0.3554, recall: 0.4579, f1: 0.4002
step: 4700 | loss: 0.330403 | [ENTITY] precision: 0.3559, recall: 0.4594, f1: 0.4011
step: 4800 | loss: 0.330483 | [ENTITY] precision: 0.3577, recall: 0.4590, f1: 0.4021
step: 4900 | loss: 0.329446 | [ENTITY] precision: 0.3612, recall: 0.4631, f1: 0.4059
step: 5000 | loss: 0.328617 | [ENTITY] precision: 0.3626, recall: 0.4640, f1: 0.4071
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2881, recall: 0.5012, f1: 0.3659
Best checkpoint
step: 5100 | loss: 0.280097 | [ENTITY] precision: 0.4146, recall: 0.5092, f1: 0.4571
step: 5200 | loss: 0.282913 | [ENTITY] precision: 0.4058, recall: 0.5021, f1: 0.4489
step: 5300 | loss: 0.290181 | [ENTITY] precision: 0.4028, recall: 0.4983, f1: 0.4455
step: 5400 | loss: 0.289168 | [ENTITY] precision: 0.4024, recall: 0.4976, f1: 0.4449
step: 5500 | loss: 0.287733 | [ENTITY] precision: 0.4025, recall: 0.5012, f1: 0.4464
step: 5600 | loss: 0.289197 | [ENTITY] precision: 0.4061, recall: 0.5042, f1: 0.4498
step: 5700 | loss: 0.286206 | [ENTITY] precision: 0.4056, recall: 0.5028, f1: 0.4490
step: 5800 | loss: 0.286294 | [ENTITY] precision: 0.4087, recall: 0.5065, f1: 0.4524
step: 5900 | loss: 0.285634 | [ENTITY] precision: 0.4066, recall: 0.5064, f1: 0.4510
step: 6000 | loss: 0.284168 | [ENTITY] precision: 0.4093, recall: 0.5087, f1: 0.4536
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2742, recall: 0.4769, f1: 0.3482
step: 6100 | loss: 0.269121 | [ENTITY] precision: 0.4138, recall: 0.5221, f1: 0.4616
step: 6200 | loss: 0.263911 | [ENTITY] precision: 0.4291, recall: 0.5289, f1: 0.4738
step: 6300 | loss: 0.270967 | [ENTITY] precision: 0.4306, recall: 0.5296, f1: 0.4750
step: 6400 | loss: 0.271045 | [ENTITY] precision: 0.4261, recall: 0.5257, f1: 0.4707
step: 6500 | loss: 0.268639 | [ENTITY] precision: 0.4266, recall: 0.5266, f1: 0.4713
step: 6600 | loss: 0.263015 | [ENTITY] precision: 0.4331, recall: 0.5326, f1: 0.4778
step: 6700 | loss: 0.260170 | [ENTITY] precision: 0.4330, recall: 0.5335, f1: 0.4780
step: 6800 | loss: 0.258114 | [ENTITY] precision: 0.4345, recall: 0.5334, f1: 0.4789
step: 6900 | loss: 0.255591 | [ENTITY] precision: 0.4382, recall: 0.5357, f1: 0.4820
step: 7000 | loss: 0.252010 | [ENTITY] precision: 0.4387, recall: 0.5364, f1: 0.4827
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2986, recall: 0.5146, f1: 0.3780
Best checkpoint
step: 7100 | loss: 0.253530 | [ENTITY] precision: 0.4728, recall: 0.5662, f1: 0.5153
step: 7200 | loss: 0.239277 | [ENTITY] precision: 0.4801, recall: 0.5786, f1: 0.5247
step: 7300 | loss: 0.234109 | [ENTITY] precision: 0.4703, recall: 0.5679, f1: 0.5145
step: 7400 | loss: 0.234804 | [ENTITY] precision: 0.4668, recall: 0.5614, f1: 0.5098
step: 7500 | loss: 0.232755 | [ENTITY] precision: 0.4687, recall: 0.5636, f1: 0.5118
step: 7600 | loss: 0.230224 | [ENTITY] precision: 0.4705, recall: 0.5671, f1: 0.5143
step: 7700 | loss: 0.228935 | [ENTITY] precision: 0.4697, recall: 0.5658, f1: 0.5133
step: 7800 | loss: 0.227697 | [ENTITY] precision: 0.4707, recall: 0.5669, f1: 0.5143
step: 7900 | loss: 0.226623 | [ENTITY] precision: 0.4707, recall: 0.5667, f1: 0.5143
step: 8000 | loss: 0.224005 | [ENTITY] precision: 0.4734, recall: 0.5691, f1: 0.5168
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2910, recall: 0.4982, f1: 0.3674
step: 8100 | loss: 0.202265 | [ENTITY] precision: 0.5003, recall: 0.5946, f1: 0.5434
step: 8200 | loss: 0.197669 | [ENTITY] precision: 0.5203, recall: 0.6133, f1: 0.5629
step: 8300 | loss: 0.203530 | [ENTITY] precision: 0.5059, recall: 0.5983, f1: 0.5482
step: 8400 | loss: 0.206332 | [ENTITY] precision: 0.5004, recall: 0.5923, f1: 0.5425
step: 8500 | loss: 0.205836 | [ENTITY] precision: 0.5000, recall: 0.5935, f1: 0.5428
step: 8600 | loss: 0.202898 | [ENTITY] precision: 0.5009, recall: 0.5952, f1: 0.5440
step: 8700 | loss: 0.201367 | [ENTITY] precision: 0.5032, recall: 0.5965, f1: 0.5459
step: 8800 | loss: 0.199009 | [ENTITY] precision: 0.5043, recall: 0.5984, f1: 0.5473
step: 8900 | loss: 0.197683 | [ENTITY] precision: 0.5083, recall: 0.6003, f1: 0.5505
step: 9000 | loss: 0.197263 | [ENTITY] precision: 0.5081, recall: 0.6011, f1: 0.5507
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3033, recall: 0.4981, f1: 0.3770
step: 9100 | loss: 0.203986 | [ENTITY] precision: 0.4904, recall: 0.5885, f1: 0.5350
step: 9200 | loss: 0.196214 | [ENTITY] precision: 0.5086, recall: 0.6035, f1: 0.5520
step: 9300 | loss: 0.196520 | [ENTITY] precision: 0.5111, recall: 0.6019, f1: 0.5528
step: 9400 | loss: 0.193571 | [ENTITY] precision: 0.5179, recall: 0.6057, f1: 0.5584
step: 9500 | loss: 0.188846 | [ENTITY] precision: 0.5193, recall: 0.6087, f1: 0.5605
step: 9600 | loss: 0.185250 | [ENTITY] precision: 0.5243, recall: 0.6128, f1: 0.5651
step: 9700 | loss: 0.183418 | [ENTITY] precision: 0.5304, recall: 0.6174, f1: 0.5706
step: 9800 | loss: 0.181930 | [ENTITY] precision: 0.5345, recall: 0.6207, f1: 0.5744
step: 9900 | loss: 0.182376 | [ENTITY] precision: 0.5351, recall: 0.6212, f1: 0.5749
step: 10000 | loss: 0.182008 | [ENTITY] precision: 0.5386, recall: 0.6245, f1: 0.5784
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2952, recall: 0.4875, f1: 0.3677

####################

Finish training proto-inter-10-5-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/proto-inter-10-5-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.4148, recall: 0.6038, f1: 0.4918
RESULT: precision: 0.4148, recall: 0.6038, f1:0.4918
ERROR ANALYSIS: fp: 0.0601, fn: 0.0087, within:0.0724, outer: 0.0674
------------------------
5-way-1-shot 
model: nnshot
max_length: 64
mode: inter
loading model and tokenizer...
loading data...
use nnshot
model-save-path: checkpoint/nnshot-inter-5-1-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 211.555926 | [ENTITY] precision: 0.0146, recall: 0.0241, f1: 0.0182
step:  200 | loss: 115.271446 | [ENTITY] precision: 0.0168, recall: 0.0292, f1: 0.0213
step:  300 | loss: 80.154472 | [ENTITY] precision: 0.0164, recall: 0.0294, f1: 0.0211
step:  400 | loss: 62.000385 | [ENTITY] precision: 0.0167, recall: 0.0303, f1: 0.0216
step:  500 | loss: 50.777748 | [ENTITY] precision: 0.0171, recall: 0.0309, f1: 0.0220
step:  600 | loss: 43.233294 | [ENTITY] precision: 0.0177, recall: 0.0321, f1: 0.0229
step:  700 | loss: 37.651566 | [ENTITY] precision: 0.0187, recall: 0.0338, f1: 0.0241
step:  800 | loss: 33.401296 | [ENTITY] precision: 0.0195, recall: 0.0353, f1: 0.0251
step:  900 | loss: 30.036018 | [ENTITY] precision: 0.0203, recall: 0.0365, f1: 0.0261
step: 1000 | loss: 27.318351 | [ENTITY] precision: 0.0209, recall: 0.0375, f1: 0.0269
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2078, recall: 0.3336, f1: 0.2561
Best checkpoint
step: 1100 | loss: 2.529826 | [ENTITY] precision: 0.0350, recall: 0.0569, f1: 0.0433
step: 1200 | loss: 2.434080 | [ENTITY] precision: 0.0371, recall: 0.0613, f1: 0.0462
step: 1300 | loss: 2.323506 | [ENTITY] precision: 0.0388, recall: 0.0637, f1: 0.0482
step: 1400 | loss: 2.230242 | [ENTITY] precision: 0.0408, recall: 0.0665, f1: 0.0505
step: 1500 | loss: 2.138834 | [ENTITY] precision: 0.0434, recall: 0.0703, f1: 0.0537
step: 1600 | loss: 2.070235 | [ENTITY] precision: 0.0460, recall: 0.0740, f1: 0.0567
step: 1700 | loss: 2.005602 | [ENTITY] precision: 0.0487, recall: 0.0780, f1: 0.0600
step: 1800 | loss: 1.949992 | [ENTITY] precision: 0.0509, recall: 0.0810, f1: 0.0625
step: 1900 | loss: 1.898665 | [ENTITY] precision: 0.0539, recall: 0.0854, f1: 0.0661
step: 2000 | loss: 1.860399 | [ENTITY] precision: 0.0562, recall: 0.0887, f1: 0.0688
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2775, recall: 0.3841, f1: 0.3222
Best checkpoint
step: 2100 | loss: 1.347553 | [ENTITY] precision: 0.0830, recall: 0.1250, f1: 0.0997
step: 2200 | loss: 1.337791 | [ENTITY] precision: 0.0860, recall: 0.1275, f1: 0.1027
step: 2300 | loss: 1.308390 | [ENTITY] precision: 0.0886, recall: 0.1301, f1: 0.1054
step: 2400 | loss: 1.321210 | [ENTITY] precision: 0.0906, recall: 0.1322, f1: 0.1075
step: 2500 | loss: 1.305309 | [ENTITY] precision: 0.0930, recall: 0.1355, f1: 0.1103
step: 2600 | loss: 1.276142 | [ENTITY] precision: 0.0963, recall: 0.1396, f1: 0.1139
step: 2700 | loss: 1.271314 | [ENTITY] precision: 0.0981, recall: 0.1424, f1: 0.1162
step: 2800 | loss: 1.244869 | [ENTITY] precision: 0.1009, recall: 0.1455, f1: 0.1191
step: 2900 | loss: 1.219481 | [ENTITY] precision: 0.1039, recall: 0.1491, f1: 0.1224
step: 3000 | loss: 1.195825 | [ENTITY] precision: 0.1062, recall: 0.1522, f1: 0.1251
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3061, recall: 0.4002, f1: 0.3469
Best checkpoint
step: 3100 | loss: 1.054514 | [ENTITY] precision: 0.1322, recall: 0.1799, f1: 0.1524
step: 3200 | loss: 1.028261 | [ENTITY] precision: 0.1397, recall: 0.1917, f1: 0.1617
step: 3300 | loss: 0.997119 | [ENTITY] precision: 0.1414, recall: 0.1942, f1: 0.1636
step: 3400 | loss: 0.988478 | [ENTITY] precision: 0.1451, recall: 0.1992, f1: 0.1679
step: 3500 | loss: 0.984248 | [ENTITY] precision: 0.1481, recall: 0.2029, f1: 0.1712
step: 3600 | loss: 0.997771 | [ENTITY] precision: 0.1492, recall: 0.2044, f1: 0.1725
step: 3700 | loss: 0.980571 | [ENTITY] precision: 0.1509, recall: 0.2062, f1: 0.1743
step: 3800 | loss: 0.959785 | [ENTITY] precision: 0.1549, recall: 0.2107, f1: 0.1786
step: 3900 | loss: 0.942546 | [ENTITY] precision: 0.1581, recall: 0.2141, f1: 0.1819
step: 4000 | loss: 0.923690 | [ENTITY] precision: 0.1619, recall: 0.2183, f1: 0.1859
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3080, recall: 0.3953, f1: 0.3463
step: 4100 | loss: 0.712331 | [ENTITY] precision: 0.1891, recall: 0.2553, f1: 0.2172
step: 4200 | loss: 0.724300 | [ENTITY] precision: 0.1995, recall: 0.2633, f1: 0.2270
step: 4300 | loss: 0.745441 | [ENTITY] precision: 0.2017, recall: 0.2657, f1: 0.2293
step: 4400 | loss: 0.739150 | [ENTITY] precision: 0.2051, recall: 0.2690, f1: 0.2327
step: 4500 | loss: 0.747166 | [ENTITY] precision: 0.2061, recall: 0.2698, f1: 0.2337
step: 4600 | loss: 0.741471 | [ENTITY] precision: 0.2091, recall: 0.2733, f1: 0.2370
step: 4700 | loss: 0.741507 | [ENTITY] precision: 0.2133, recall: 0.2778, f1: 0.2413
step: 4800 | loss: 0.741300 | [ENTITY] precision: 0.2170, recall: 0.2823, f1: 0.2454
step: 4900 | loss: 0.734587 | [ENTITY] precision: 0.2203, recall: 0.2853, f1: 0.2486
step: 5000 | loss: 0.722492 | [ENTITY] precision: 0.2249, recall: 0.2903, f1: 0.2534
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2998, recall: 0.3698, f1: 0.3311
step: 5100 | loss: 0.586814 | [ENTITY] precision: 0.2608, recall: 0.3246, f1: 0.2892
step: 5200 | loss: 0.637743 | [ENTITY] precision: 0.2632, recall: 0.3304, f1: 0.2930
step: 5300 | loss: 0.614374 | [ENTITY] precision: 0.2660, recall: 0.3330, f1: 0.2957
step: 5400 | loss: 0.599923 | [ENTITY] precision: 0.2687, recall: 0.3369, f1: 0.2990
step: 5500 | loss: 0.582378 | [ENTITY] precision: 0.2716, recall: 0.3387, f1: 0.3014
step: 5600 | loss: 0.570227 | [ENTITY] precision: 0.2782, recall: 0.3458, f1: 0.3083
step: 5700 | loss: 0.562129 | [ENTITY] precision: 0.2819, recall: 0.3499, f1: 0.3123
step: 5800 | loss: 0.558822 | [ENTITY] precision: 0.2854, recall: 0.3540, f1: 0.3160
step: 5900 | loss: 0.557667 | [ENTITY] precision: 0.2867, recall: 0.3556, f1: 0.3175
step: 6000 | loss: 0.549407 | [ENTITY] precision: 0.2888, recall: 0.3578, f1: 0.3197
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2996, recall: 0.3590, f1: 0.3266
step: 6100 | loss: 0.502543 | [ENTITY] precision: 0.3266, recall: 0.4009, f1: 0.3600
step: 6200 | loss: 0.496983 | [ENTITY] precision: 0.3293, recall: 0.4036, f1: 0.3627
step: 6300 | loss: 0.469181 | [ENTITY] precision: 0.3314, recall: 0.4054, f1: 0.3647
step: 6400 | loss: 0.457316 | [ENTITY] precision: 0.3348, recall: 0.4083, f1: 0.3679
step: 6500 | loss: 0.446772 | [ENTITY] precision: 0.3401, recall: 0.4120, f1: 0.3726
step: 6600 | loss: 0.437138 | [ENTITY] precision: 0.3426, recall: 0.4143, f1: 0.3751
step: 6700 | loss: 0.426039 | [ENTITY] precision: 0.3452, recall: 0.4160, f1: 0.3773
step: 6800 | loss: 0.420229 | [ENTITY] precision: 0.3486, recall: 0.4182, f1: 0.3802
step: 6900 | loss: 0.414085 | [ENTITY] precision: 0.3507, recall: 0.4209, f1: 0.3826
step: 7000 | loss: 0.406659 | [ENTITY] precision: 0.3530, recall: 0.4231, f1: 0.3849
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2990, recall: 0.3565, f1: 0.3252
step: 7100 | loss: 0.340455 | [ENTITY] precision: 0.4002, recall: 0.4624, f1: 0.4291
step: 7200 | loss: 0.342232 | [ENTITY] precision: 0.4031, recall: 0.4668, f1: 0.4327
step: 7300 | loss: 0.327539 | [ENTITY] precision: 0.4060, recall: 0.4709, f1: 0.4361
step: 7400 | loss: 0.331265 | [ENTITY] precision: 0.4073, recall: 0.4719, f1: 0.4372
step: 7500 | loss: 0.327942 | [ENTITY] precision: 0.4089, recall: 0.4759, f1: 0.4399
step: 7600 | loss: 0.324908 | [ENTITY] precision: 0.4105, recall: 0.4763, f1: 0.4410
step: 7700 | loss: 0.324093 | [ENTITY] precision: 0.4131, recall: 0.4798, f1: 0.4439
step: 7800 | loss: 0.318508 | [ENTITY] precision: 0.4161, recall: 0.4823, f1: 0.4468
step: 7900 | loss: 0.317403 | [ENTITY] precision: 0.4186, recall: 0.4843, f1: 0.4491
step: 8000 | loss: 0.312343 | [ENTITY] precision: 0.4221, recall: 0.4873, f1: 0.4524
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2955, recall: 0.3472, f1: 0.3193
step: 8100 | loss: 0.276377 | [ENTITY] precision: 0.4351, recall: 0.5043, f1: 0.4672
step: 8200 | loss: 0.285710 | [ENTITY] precision: 0.4425, recall: 0.5100, f1: 0.4738
step: 8300 | loss: 0.286748 | [ENTITY] precision: 0.4447, recall: 0.5109, f1: 0.4755
step: 8400 | loss: 0.288378 | [ENTITY] precision: 0.4511, recall: 0.5167, f1: 0.4817
step: 8500 | loss: 0.281795 | [ENTITY] precision: 0.4587, recall: 0.5219, f1: 0.4882
step: 8600 | loss: 0.277776 | [ENTITY] precision: 0.4610, recall: 0.5239, f1: 0.4904
step: 8700 | loss: 0.277677 | [ENTITY] precision: 0.4634, recall: 0.5254, f1: 0.4924
step: 8800 | loss: 0.271825 | [ENTITY] precision: 0.4656, recall: 0.5275, f1: 0.4946
step: 8900 | loss: 0.267026 | [ENTITY] precision: 0.4684, recall: 0.5297, f1: 0.4971
step: 9000 | loss: 0.264465 | [ENTITY] precision: 0.4699, recall: 0.5314, f1: 0.4988
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2828, recall: 0.3352, f1: 0.3068
step: 9100 | loss: 0.270286 | [ENTITY] precision: 0.4951, recall: 0.5578, f1: 0.5246
step: 9200 | loss: 0.261284 | [ENTITY] precision: 0.4998, recall: 0.5602, f1: 0.5283
step: 9300 | loss: 0.249065 | [ENTITY] precision: 0.5063, recall: 0.5664, f1: 0.5347
step: 9400 | loss: 0.242125 | [ENTITY] precision: 0.5103, recall: 0.5695, f1: 0.5383
step: 9500 | loss: 0.240127 | [ENTITY] precision: 0.5121, recall: 0.5709, f1: 0.5399
step: 9600 | loss: 0.232381 | [ENTITY] precision: 0.5131, recall: 0.5721, f1: 0.5410
step: 9700 | loss: 0.228341 | [ENTITY] precision: 0.5133, recall: 0.5719, f1: 0.5410
step: 9800 | loss: 0.227427 | [ENTITY] precision: 0.5160, recall: 0.5746, f1: 0.5437
step: 9900 | loss: 0.225130 | [ENTITY] precision: 0.5185, recall: 0.5759, f1: 0.5457
step: 10000 | loss: 0.227559 | [ENTITY] precision: 0.5194, recall: 0.5767, f1: 0.5466
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2878, recall: 0.3347, f1: 0.3095

####################

Finish training nnshot-inter-5-1-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/nnshot-inter-5-1-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.4418, recall: 0.5427, f1: 0.4871
RESULT: precision: 0.4418, recall: 0.5427, f1:0.4871
ERROR ANALYSIS: fp: 0.0320, fn: 0.0304, within:0.0583, outer: 0.0850
------------------------
5-way-5-shot 
model: nnshot
max_length: 32
mode: inter
loading model and tokenizer...
loading data...
use nnshot
model-save-path: checkpoint/nnshot-inter-5-5-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 189.192155 | [ENTITY] precision: 0.0283, recall: 0.0444, f1: 0.0345
step:  200 | loss: 110.204257 | [ENTITY] precision: 0.0230, recall: 0.0403, f1: 0.0293
step:  300 | loss: 79.208518 | [ENTITY] precision: 0.0190, recall: 0.0351, f1: 0.0246
step:  400 | loss: 62.133272 | [ENTITY] precision: 0.0172, recall: 0.0327, f1: 0.0225
step:  500 | loss: 51.496532 | [ENTITY] precision: 0.0154, recall: 0.0297, f1: 0.0203
step:  600 | loss: 44.092584 | [ENTITY] precision: 0.0143, recall: 0.0278, f1: 0.0189
step:  700 | loss: 38.605354 | [ENTITY] precision: 0.0137, recall: 0.0268, f1: 0.0181
step:  800 | loss: 34.314904 | [ENTITY] precision: 0.0132, recall: 0.0260, f1: 0.0175
step:  900 | loss: 30.917139 | [ENTITY] precision: 0.0130, recall: 0.0258, f1: 0.0173
step: 1000 | loss: 28.106009 | [ENTITY] precision: 0.0127, recall: 0.0250, f1: 0.0168
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1558, recall: 0.2794, f1: 0.2001
Best checkpoint
step: 1100 | loss: 2.447833 | [ENTITY] precision: 0.0182, recall: 0.0358, f1: 0.0241
step: 1200 | loss: 2.302303 | [ENTITY] precision: 0.0189, recall: 0.0371, f1: 0.0250
step: 1300 | loss: 2.304239 | [ENTITY] precision: 0.0211, recall: 0.0408, f1: 0.0278
step: 1400 | loss: 2.291364 | [ENTITY] precision: 0.0232, recall: 0.0445, f1: 0.0305
step: 1500 | loss: 2.254511 | [ENTITY] precision: 0.0239, recall: 0.0454, f1: 0.0313
step: 1600 | loss: 2.183002 | [ENTITY] precision: 0.0250, recall: 0.0470, f1: 0.0326
step: 1700 | loss: 2.117815 | [ENTITY] precision: 0.0264, recall: 0.0493, f1: 0.0344
step: 1800 | loss: 2.063578 | [ENTITY] precision: 0.0280, recall: 0.0518, f1: 0.0364
step: 1900 | loss: 2.011254 | [ENTITY] precision: 0.0295, recall: 0.0542, f1: 0.0382
step: 2000 | loss: 1.963988 | [ENTITY] precision: 0.0309, recall: 0.0565, f1: 0.0399
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2438, recall: 0.3795, f1: 0.2969
Best checkpoint
step: 2100 | loss: 1.376255 | [ENTITY] precision: 0.0466, recall: 0.0761, f1: 0.0578
step: 2200 | loss: 1.414273 | [ENTITY] precision: 0.0479, recall: 0.0787, f1: 0.0595
step: 2300 | loss: 1.352724 | [ENTITY] precision: 0.0490, recall: 0.0807, f1: 0.0610
step: 2400 | loss: 1.338573 | [ENTITY] precision: 0.0529, recall: 0.0861, f1: 0.0655
step: 2500 | loss: 1.281744 | [ENTITY] precision: 0.0533, recall: 0.0875, f1: 0.0662
step: 2600 | loss: 1.268731 | [ENTITY] precision: 0.0542, recall: 0.0895, f1: 0.0675
step: 2700 | loss: 1.251702 | [ENTITY] precision: 0.0551, recall: 0.0903, f1: 0.0684
step: 2800 | loss: 1.235546 | [ENTITY] precision: 0.0563, recall: 0.0923, f1: 0.0699
step: 2900 | loss: 1.220468 | [ENTITY] precision: 0.0571, recall: 0.0934, f1: 0.0709
step: 3000 | loss: 1.206669 | [ENTITY] precision: 0.0588, recall: 0.0960, f1: 0.0729
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2965, recall: 0.4256, f1: 0.3495
Best checkpoint
step: 3100 | loss: 1.030280 | [ENTITY] precision: 0.0759, recall: 0.1210, f1: 0.0933
step: 3200 | loss: 1.049559 | [ENTITY] precision: 0.0759, recall: 0.1193, f1: 0.0927
step: 3300 | loss: 1.016075 | [ENTITY] precision: 0.0742, recall: 0.1175, f1: 0.0910
step: 3400 | loss: 0.976018 | [ENTITY] precision: 0.0763, recall: 0.1198, f1: 0.0932
step: 3500 | loss: 0.954761 | [ENTITY] precision: 0.0775, recall: 0.1211, f1: 0.0945
step: 3600 | loss: 0.939312 | [ENTITY] precision: 0.0778, recall: 0.1216, f1: 0.0949
step: 3700 | loss: 0.931508 | [ENTITY] precision: 0.0803, recall: 0.1249, f1: 0.0977
step: 3800 | loss: 0.919825 | [ENTITY] precision: 0.0822, recall: 0.1271, f1: 0.0998
step: 3900 | loss: 0.900533 | [ENTITY] precision: 0.0839, recall: 0.1290, f1: 0.1017
step: 4000 | loss: 0.889292 | [ENTITY] precision: 0.0852, recall: 0.1308, f1: 0.1031
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3133, recall: 0.4364, f1: 0.3647
Best checkpoint
step: 4100 | loss: 0.749482 | [ENTITY] precision: 0.1029, recall: 0.1534, f1: 0.1232
step: 4200 | loss: 0.712117 | [ENTITY] precision: 0.1151, recall: 0.1662, f1: 0.1360
step: 4300 | loss: 0.718944 | [ENTITY] precision: 0.1185, recall: 0.1711, f1: 0.1400
step: 4400 | loss: 0.713677 | [ENTITY] precision: 0.1209, recall: 0.1762, f1: 0.1434
step: 4500 | loss: 0.716215 | [ENTITY] precision: 0.1189, recall: 0.1733, f1: 0.1411
step: 4600 | loss: 0.711298 | [ENTITY] precision: 0.1214, recall: 0.1766, f1: 0.1439
step: 4700 | loss: 0.702789 | [ENTITY] precision: 0.1226, recall: 0.1789, f1: 0.1455
step: 4800 | loss: 0.694806 | [ENTITY] precision: 0.1249, recall: 0.1822, f1: 0.1482
step: 4900 | loss: 0.684311 | [ENTITY] precision: 0.1279, recall: 0.1850, f1: 0.1512
step: 5000 | loss: 0.676221 | [ENTITY] precision: 0.1296, recall: 0.1875, f1: 0.1533
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3435, recall: 0.4592, f1: 0.3930
Best checkpoint
step: 5100 | loss: 0.602544 | [ENTITY] precision: 0.1647, recall: 0.2292, f1: 0.1917
step: 5200 | loss: 0.590182 | [ENTITY] precision: 0.1657, recall: 0.2318, f1: 0.1932
step: 5300 | loss: 0.590606 | [ENTITY] precision: 0.1634, recall: 0.2292, f1: 0.1908
step: 5400 | loss: 0.570540 | [ENTITY] precision: 0.1678, recall: 0.2355, f1: 0.1960
step: 5500 | loss: 0.567356 | [ENTITY] precision: 0.1680, recall: 0.2338, f1: 0.1955
step: 5600 | loss: 0.558314 | [ENTITY] precision: 0.1684, recall: 0.2332, f1: 0.1956
step: 5700 | loss: 0.549906 | [ENTITY] precision: 0.1710, recall: 0.2343, f1: 0.1977
step: 5800 | loss: 0.546487 | [ENTITY] precision: 0.1732, recall: 0.2367, f1: 0.2000
step: 5900 | loss: 0.543585 | [ENTITY] precision: 0.1764, recall: 0.2404, f1: 0.2035
step: 6000 | loss: 0.534796 | [ENTITY] precision: 0.1784, recall: 0.2427, f1: 0.2057
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3503, recall: 0.4594, f1: 0.3975
Best checkpoint
step: 6100 | loss: 0.496391 | [ENTITY] precision: 0.1956, recall: 0.2600, f1: 0.2232
step: 6200 | loss: 0.491608 | [ENTITY] precision: 0.1968, recall: 0.2615, f1: 0.2246
step: 6300 | loss: 0.474900 | [ENTITY] precision: 0.2015, recall: 0.2658, f1: 0.2292
step: 6400 | loss: 0.477912 | [ENTITY] precision: 0.2062, recall: 0.2708, f1: 0.2342
step: 6500 | loss: 0.464415 | [ENTITY] precision: 0.2097, recall: 0.2766, f1: 0.2386
step: 6600 | loss: 0.459207 | [ENTITY] precision: 0.2113, recall: 0.2787, f1: 0.2404
step: 6700 | loss: 0.450724 | [ENTITY] precision: 0.2165, recall: 0.2846, f1: 0.2459
step: 6800 | loss: 0.448426 | [ENTITY] precision: 0.2171, recall: 0.2856, f1: 0.2467
step: 6900 | loss: 0.441514 | [ENTITY] precision: 0.2218, recall: 0.2910, f1: 0.2517
step: 7000 | loss: 0.437312 | [ENTITY] precision: 0.2227, recall: 0.2925, f1: 0.2529
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3449, recall: 0.4583, f1: 0.3936
step: 7100 | loss: 0.385703 | [ENTITY] precision: 0.2356, recall: 0.3152, f1: 0.2697
step: 7200 | loss: 0.365778 | [ENTITY] precision: 0.2584, recall: 0.3316, f1: 0.2905
step: 7300 | loss: 0.369969 | [ENTITY] precision: 0.2602, recall: 0.3366, f1: 0.2935
step: 7400 | loss: 0.369001 | [ENTITY] precision: 0.2634, recall: 0.3382, f1: 0.2961
step: 7500 | loss: 0.364784 | [ENTITY] precision: 0.2644, recall: 0.3391, f1: 0.2971
step: 7600 | loss: 0.360650 | [ENTITY] precision: 0.2676, recall: 0.3419, f1: 0.3002
step: 7700 | loss: 0.357134 | [ENTITY] precision: 0.2712, recall: 0.3441, f1: 0.3033
step: 7800 | loss: 0.352905 | [ENTITY] precision: 0.2721, recall: 0.3440, f1: 0.3039
step: 7900 | loss: 0.349230 | [ENTITY] precision: 0.2723, recall: 0.3453, f1: 0.3045
step: 8000 | loss: 0.346002 | [ENTITY] precision: 0.2753, recall: 0.3480, f1: 0.3074
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3548, recall: 0.4648, f1: 0.4025
Best checkpoint
step: 8100 | loss: 0.331682 | [ENTITY] precision: 0.3031, recall: 0.3593, f1: 0.3288
step: 8200 | loss: 0.321752 | [ENTITY] precision: 0.3011, recall: 0.3610, f1: 0.3284
step: 8300 | loss: 0.307261 | [ENTITY] precision: 0.3168, recall: 0.3795, f1: 0.3453
step: 8400 | loss: 0.305400 | [ENTITY] precision: 0.3175, recall: 0.3799, f1: 0.3459
step: 8500 | loss: 0.303295 | [ENTITY] precision: 0.3201, recall: 0.3849, f1: 0.3495
step: 8600 | loss: 0.298329 | [ENTITY] precision: 0.3239, recall: 0.3910, f1: 0.3543
step: 8700 | loss: 0.296833 | [ENTITY] precision: 0.3232, recall: 0.3914, f1: 0.3540
step: 8800 | loss: 0.294393 | [ENTITY] precision: 0.3255, recall: 0.3946, f1: 0.3567
step: 8900 | loss: 0.292349 | [ENTITY] precision: 0.3281, recall: 0.3967, f1: 0.3592
step: 9000 | loss: 0.289626 | [ENTITY] precision: 0.3300, recall: 0.3985, f1: 0.3610
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3617, recall: 0.4634, f1: 0.4063
Best checkpoint
step: 9100 | loss: 0.277839 | [ENTITY] precision: 0.3247, recall: 0.4088, f1: 0.3619
step: 9200 | loss: 0.267706 | [ENTITY] precision: 0.3393, recall: 0.4186, f1: 0.3748
step: 9300 | loss: 0.267690 | [ENTITY] precision: 0.3460, recall: 0.4233, f1: 0.3807
step: 9400 | loss: 0.266847 | [ENTITY] precision: 0.3487, recall: 0.4211, f1: 0.3815
step: 9500 | loss: 0.265758 | [ENTITY] precision: 0.3493, recall: 0.4224, f1: 0.3824
step: 9600 | loss: 0.264131 | [ENTITY] precision: 0.3517, recall: 0.4253, f1: 0.3850
step: 9700 | loss: 0.261369 | [ENTITY] precision: 0.3550, recall: 0.4300, f1: 0.3889
step: 9800 | loss: 0.259218 | [ENTITY] precision: 0.3577, recall: 0.4322, f1: 0.3914
step: 9900 | loss: 0.257816 | [ENTITY] precision: 0.3598, recall: 0.4336, f1: 0.3933
step: 10000 | loss: 0.258535 | [ENTITY] precision: 0.3641, recall: 0.4372, f1: 0.3973
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.3670, recall: 0.4671, f1: 0.4111
Best checkpoint

####################

Finish training nnshot-inter-5-5-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/nnshot-inter-5-5-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.5053, recall: 0.6036, f1: 0.5501
RESULT: precision: 0.5053, recall: 0.6036, f1:0.5501
ERROR ANALYSIS: fp: 0.0349, fn: 0.0335, within:0.0342, outer: 0.0507
------------------------
10-way-1-shot 
model: nnshot
max_length: 64
mode: inter
loading model and tokenizer...
loading data...
use nnshot
model-save-path: checkpoint/nnshot-inter-10-1-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 264.496393 | [ENTITY] precision: 0.0078, recall: 0.0144, f1: 0.0101
step:  200 | loss: 149.356629 | [ENTITY] precision: 0.0104, recall: 0.0202, f1: 0.0138
step:  300 | loss: 105.519341 | [ENTITY] precision: 0.0087, recall: 0.0176, f1: 0.0117
step:  400 | loss: 81.811750 | [ENTITY] precision: 0.0081, recall: 0.0163, f1: 0.0108
step:  500 | loss: 67.100408 | [ENTITY] precision: 0.0073, recall: 0.0148, f1: 0.0097
step:  600 | loss: 57.215861 | [ENTITY] precision: 0.0072, recall: 0.0144, f1: 0.0096
step:  700 | loss: 49.958035 | [ENTITY] precision: 0.0070, recall: 0.0142, f1: 0.0094
step:  800 | loss: 44.533447 | [ENTITY] precision: 0.0066, recall: 0.0134, f1: 0.0089
step:  900 | loss: 40.212918 | [ENTITY] precision: 0.0068, recall: 0.0137, f1: 0.0091
step: 1000 | loss: 36.699132 | [ENTITY] precision: 0.0069, recall: 0.0138, f1: 0.0092
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.0965, recall: 0.1837, f1: 0.1265
Best checkpoint
step: 1100 | loss: 4.864790 | [ENTITY] precision: 0.0053, recall: 0.0101, f1: 0.0070
step: 1200 | loss: 4.562089 | [ENTITY] precision: 0.0079, recall: 0.0150, f1: 0.0104
step: 1300 | loss: 4.247843 | [ENTITY] precision: 0.0091, recall: 0.0173, f1: 0.0119
step: 1400 | loss: 4.002958 | [ENTITY] precision: 0.0093, recall: 0.0177, f1: 0.0122
step: 1500 | loss: 3.813581 | [ENTITY] precision: 0.0096, recall: 0.0180, f1: 0.0125
step: 1600 | loss: 3.642246 | [ENTITY] precision: 0.0095, recall: 0.0178, f1: 0.0124
step: 1700 | loss: 3.550686 | [ENTITY] precision: 0.0104, recall: 0.0193, f1: 0.0135
step: 1800 | loss: 3.464707 | [ENTITY] precision: 0.0118, recall: 0.0219, f1: 0.0153
step: 1900 | loss: 3.356740 | [ENTITY] precision: 0.0125, recall: 0.0232, f1: 0.0163
step: 2000 | loss: 3.278739 | [ENTITY] precision: 0.0133, recall: 0.0245, f1: 0.0172
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1480, recall: 0.2556, f1: 0.1875
Best checkpoint
step: 2100 | loss: 2.306564 | [ENTITY] precision: 0.0205, recall: 0.0370, f1: 0.0264
step: 2200 | loss: 2.155259 | [ENTITY] precision: 0.0221, recall: 0.0392, f1: 0.0283
step: 2300 | loss: 2.161057 | [ENTITY] precision: 0.0218, recall: 0.0380, f1: 0.0277
step: 2400 | loss: 2.126898 | [ENTITY] precision: 0.0221, recall: 0.0385, f1: 0.0281
step: 2500 | loss: 2.107555 | [ENTITY] precision: 0.0236, recall: 0.0409, f1: 0.0300
step: 2600 | loss: 2.059338 | [ENTITY] precision: 0.0241, recall: 0.0418, f1: 0.0305
step: 2700 | loss: 2.059883 | [ENTITY] precision: 0.0237, recall: 0.0410, f1: 0.0301
step: 2800 | loss: 2.035543 | [ENTITY] precision: 0.0240, recall: 0.0416, f1: 0.0305
step: 2900 | loss: 2.015815 | [ENTITY] precision: 0.0245, recall: 0.0420, f1: 0.0309
step: 3000 | loss: 2.010084 | [ENTITY] precision: 0.0248, recall: 0.0427, f1: 0.0314
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1784, recall: 0.2689, f1: 0.2145
Best checkpoint
step: 3100 | loss: 1.647633 | [ENTITY] precision: 0.0343, recall: 0.0549, f1: 0.0422
step: 3200 | loss: 1.629810 | [ENTITY] precision: 0.0346, recall: 0.0546, f1: 0.0424
step: 3300 | loss: 1.647431 | [ENTITY] precision: 0.0334, recall: 0.0535, f1: 0.0411
step: 3400 | loss: 1.597698 | [ENTITY] precision: 0.0333, recall: 0.0533, f1: 0.0410
step: 3500 | loss: 1.584777 | [ENTITY] precision: 0.0355, recall: 0.0568, f1: 0.0437
step: 3600 | loss: 1.569349 | [ENTITY] precision: 0.0370, recall: 0.0594, f1: 0.0456
step: 3700 | loss: 1.548829 | [ENTITY] precision: 0.0373, recall: 0.0593, f1: 0.0458
step: 3800 | loss: 1.564540 | [ENTITY] precision: 0.0377, recall: 0.0601, f1: 0.0464
step: 3900 | loss: 1.566120 | [ENTITY] precision: 0.0375, recall: 0.0597, f1: 0.0461
step: 4000 | loss: 1.558117 | [ENTITY] precision: 0.0376, recall: 0.0598, f1: 0.0462
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2012, recall: 0.2891, f1: 0.2373
Best checkpoint
step: 4100 | loss: 1.514882 | [ENTITY] precision: 0.0492, recall: 0.0735, f1: 0.0589
step: 4200 | loss: 1.465241 | [ENTITY] precision: 0.0487, recall: 0.0743, f1: 0.0588
step: 4300 | loss: 1.373888 | [ENTITY] precision: 0.0510, recall: 0.0785, f1: 0.0618
step: 4400 | loss: 1.413179 | [ENTITY] precision: 0.0510, recall: 0.0781, f1: 0.0617
step: 4500 | loss: 1.405528 | [ENTITY] precision: 0.0518, recall: 0.0793, f1: 0.0626
step: 4600 | loss: 1.389489 | [ENTITY] precision: 0.0536, recall: 0.0825, f1: 0.0650
step: 4700 | loss: 1.373789 | [ENTITY] precision: 0.0558, recall: 0.0853, f1: 0.0675
step: 4800 | loss: 1.350724 | [ENTITY] precision: 0.0593, recall: 0.0905, f1: 0.0717
step: 4900 | loss: 1.356410 | [ENTITY] precision: 0.0614, recall: 0.0932, f1: 0.0741
step: 5000 | loss: 1.343726 | [ENTITY] precision: 0.0636, recall: 0.0964, f1: 0.0766
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2159, recall: 0.2961, f1: 0.2497
Best checkpoint
step: 5100 | loss: 1.090287 | [ENTITY] precision: 0.0877, recall: 0.1267, f1: 0.1037
step: 5200 | loss: 1.116530 | [ENTITY] precision: 0.0847, recall: 0.1231, f1: 0.1004
step: 5300 | loss: 1.087997 | [ENTITY] precision: 0.0846, recall: 0.1242, f1: 0.1007
step: 5400 | loss: 1.086567 | [ENTITY] precision: 0.0834, recall: 0.1219, f1: 0.0990
step: 5500 | loss: 1.091284 | [ENTITY] precision: 0.0841, recall: 0.1240, f1: 0.1002
step: 5600 | loss: 1.102368 | [ENTITY] precision: 0.0845, recall: 0.1247, f1: 0.1007
step: 5700 | loss: 1.069461 | [ENTITY] precision: 0.0860, recall: 0.1265, f1: 0.1024
step: 5800 | loss: 1.062424 | [ENTITY] precision: 0.0880, recall: 0.1286, f1: 0.1045
step: 5900 | loss: 1.044155 | [ENTITY] precision: 0.0902, recall: 0.1312, f1: 0.1069
step: 6000 | loss: 1.025505 | [ENTITY] precision: 0.0914, recall: 0.1327, f1: 0.1083
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2211, recall: 0.3073, f1: 0.2572
Best checkpoint
step: 6100 | loss: 0.952101 | [ENTITY] precision: 0.1094, recall: 0.1497, f1: 0.1264
step: 6200 | loss: 0.973412 | [ENTITY] precision: 0.1093, recall: 0.1516, f1: 0.1270
step: 6300 | loss: 0.927290 | [ENTITY] precision: 0.1082, recall: 0.1497, f1: 0.1256
step: 6400 | loss: 0.895713 | [ENTITY] precision: 0.1119, recall: 0.1529, f1: 0.1292
step: 6500 | loss: 0.869314 | [ENTITY] precision: 0.1135, recall: 0.1554, f1: 0.1312
step: 6600 | loss: 0.876703 | [ENTITY] precision: 0.1159, recall: 0.1582, f1: 0.1338
step: 6700 | loss: 0.846818 | [ENTITY] precision: 0.1168, recall: 0.1587, f1: 0.1345
step: 6800 | loss: 0.830211 | [ENTITY] precision: 0.1202, recall: 0.1631, f1: 0.1384
step: 6900 | loss: 0.819198 | [ENTITY] precision: 0.1228, recall: 0.1660, f1: 0.1412
step: 7000 | loss: 0.818843 | [ENTITY] precision: 0.1235, recall: 0.1661, f1: 0.1417
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2130, recall: 0.2929, f1: 0.2466
step: 7100 | loss: 0.710231 | [ENTITY] precision: 0.1299, recall: 0.1763, f1: 0.1496
step: 7200 | loss: 0.721653 | [ENTITY] precision: 0.1360, recall: 0.1867, f1: 0.1574
step: 7300 | loss: 0.770934 | [ENTITY] precision: 0.1382, recall: 0.1855, f1: 0.1584
step: 7400 | loss: 0.728952 | [ENTITY] precision: 0.1461, recall: 0.1952, f1: 0.1672
step: 7500 | loss: 0.712780 | [ENTITY] precision: 0.1494, recall: 0.1990, f1: 0.1706
step: 7600 | loss: 0.680896 | [ENTITY] precision: 0.1489, recall: 0.1982, f1: 0.1700
step: 7700 | loss: 0.686491 | [ENTITY] precision: 0.1536, recall: 0.2029, f1: 0.1749
step: 7800 | loss: 0.672462 | [ENTITY] precision: 0.1575, recall: 0.2069, f1: 0.1789
step: 7900 | loss: 0.668819 | [ENTITY] precision: 0.1581, recall: 0.2063, f1: 0.1790
step: 8000 | loss: 0.657408 | [ENTITY] precision: 0.1591, recall: 0.2070, f1: 0.1799
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2159, recall: 0.2942, f1: 0.2490
step: 8100 | loss: 0.529051 | [ENTITY] precision: 0.1971, recall: 0.2452, f1: 0.2185
step: 8200 | loss: 0.545582 | [ENTITY] precision: 0.1976, recall: 0.2459, f1: 0.2191
step: 8300 | loss: 0.620603 | [ENTITY] precision: 0.1875, recall: 0.2357, f1: 0.2089
step: 8400 | loss: 0.605148 | [ENTITY] precision: 0.1905, recall: 0.2394, f1: 0.2122
step: 8500 | loss: 0.592799 | [ENTITY] precision: 0.1942, recall: 0.2439, f1: 0.2162
step: 8600 | loss: 0.611421 | [ENTITY] precision: 0.1966, recall: 0.2469, f1: 0.2189
step: 8700 | loss: 0.612288 | [ENTITY] precision: 0.2020, recall: 0.2513, f1: 0.2240
step: 8800 | loss: 0.605850 | [ENTITY] precision: 0.2044, recall: 0.2539, f1: 0.2264
step: 8900 | loss: 0.590849 | [ENTITY] precision: 0.2057, recall: 0.2560, f1: 0.2281
step: 9000 | loss: 0.597148 | [ENTITY] precision: 0.2077, recall: 0.2578, f1: 0.2301
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2302, recall: 0.3012, f1: 0.2610
Best checkpoint
step: 9100 | loss: 0.503684 | [ENTITY] precision: 0.2310, recall: 0.2835, f1: 0.2546
step: 9200 | loss: 0.523289 | [ENTITY] precision: 0.2403, recall: 0.2940, f1: 0.2644
step: 9300 | loss: 0.498986 | [ENTITY] precision: 0.2361, recall: 0.2874, f1: 0.2592
step: 9400 | loss: 0.522179 | [ENTITY] precision: 0.2393, recall: 0.2916, f1: 0.2629
step: 9500 | loss: 0.497855 | [ENTITY] precision: 0.2423, recall: 0.2931, f1: 0.2653
step: 9600 | loss: 0.497168 | [ENTITY] precision: 0.2456, recall: 0.2952, f1: 0.2682
step: 9700 | loss: 0.511602 | [ENTITY] precision: 0.2460, recall: 0.2960, f1: 0.2687
step: 9800 | loss: 0.503622 | [ENTITY] precision: 0.2477, recall: 0.2967, f1: 0.2700
step: 9900 | loss: 0.503059 | [ENTITY] precision: 0.2510, recall: 0.3007, f1: 0.2737
step: 10000 | loss: 0.502653 | [ENTITY] precision: 0.2527, recall: 0.3030, f1: 0.2756
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2273, recall: 0.2961, f1: 0.2572

####################

Finish training nnshot-inter-10-1-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/nnshot-inter-10-1-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.3454, recall: 0.4401, f1: 0.3870
RESULT: precision: 0.3454, recall: 0.4401, f1:0.3870
ERROR ANALYSIS: fp: 0.0339, fn: 0.0366, within:0.1176, outer: 0.1278
------------------------
10-way-5-shot 
model: nnshot
max_length: 32
mode: inter
loading model and tokenizer...
loading data...
use nnshot
model-save-path: checkpoint/nnshot-inter-10-5-seed0.pth.tar
Start training...
Use bert optim!
step:  100 | loss: 167.061305 | [ENTITY] precision: 0.0092, recall: 0.0157, f1: 0.0116
step:  200 | loss: 97.828569 | [ENTITY] precision: 0.0091, recall: 0.0181, f1: 0.0121
step:  300 | loss: 70.828804 | [ENTITY] precision: 0.0084, recall: 0.0175, f1: 0.0114
step:  400 | loss: 55.820237 | [ENTITY] precision: 0.0074, recall: 0.0158, f1: 0.0101
step:  500 | loss: 46.428555 | [ENTITY] precision: 0.0063, recall: 0.0137, f1: 0.0086
step:  600 | loss: 39.695077 | [ENTITY] precision: 0.0057, recall: 0.0124, f1: 0.0078
step:  700 | loss: 34.820136 | [ENTITY] precision: 0.0054, recall: 0.0118, f1: 0.0074
step:  800 | loss: 31.011005 | [ENTITY] precision: 0.0052, recall: 0.0114, f1: 0.0071
step:  900 | loss: 27.923828 | [ENTITY] precision: 0.0050, recall: 0.0110, f1: 0.0069
step: 1000 | loss: 25.421908 | [ENTITY] precision: 0.0049, recall: 0.0108, f1: 0.0068
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.0767, recall: 0.1747, f1: 0.1066
Best checkpoint
step: 1100 | loss: 2.703612 | [ENTITY] precision: 0.0040, recall: 0.0085, f1: 0.0055
step: 1200 | loss: 2.552574 | [ENTITY] precision: 0.0044, recall: 0.0093, f1: 0.0059
step: 1300 | loss: 2.491636 | [ENTITY] precision: 0.0044, recall: 0.0090, f1: 0.0059
step: 1400 | loss: 2.380232 | [ENTITY] precision: 0.0043, recall: 0.0088, f1: 0.0058
step: 1500 | loss: 2.324054 | [ENTITY] precision: 0.0046, recall: 0.0094, f1: 0.0062
step: 1600 | loss: 2.267629 | [ENTITY] precision: 0.0057, recall: 0.0114, f1: 0.0076
step: 1700 | loss: 2.206204 | [ENTITY] precision: 0.0058, recall: 0.0114, f1: 0.0077
step: 1800 | loss: 2.144660 | [ENTITY] precision: 0.0065, recall: 0.0127, f1: 0.0086
step: 1900 | loss: 2.102063 | [ENTITY] precision: 0.0073, recall: 0.0142, f1: 0.0096
step: 2000 | loss: 2.053166 | [ENTITY] precision: 0.0079, recall: 0.0152, f1: 0.0104
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1363, recall: 0.2574, f1: 0.1782
Best checkpoint
step: 2100 | loss: 1.758444 | [ENTITY] precision: 0.0074, recall: 0.0133, f1: 0.0095
step: 2200 | loss: 1.590694 | [ENTITY] precision: 0.0113, recall: 0.0203, f1: 0.0145
step: 2300 | loss: 1.550013 | [ENTITY] precision: 0.0128, recall: 0.0229, f1: 0.0164
step: 2400 | loss: 1.538316 | [ENTITY] precision: 0.0128, recall: 0.0225, f1: 0.0163
step: 2500 | loss: 1.512845 | [ENTITY] precision: 0.0139, recall: 0.0243, f1: 0.0177
step: 2600 | loss: 1.484180 | [ENTITY] precision: 0.0148, recall: 0.0257, f1: 0.0188
step: 2700 | loss: 1.465671 | [ENTITY] precision: 0.0159, recall: 0.0276, f1: 0.0202
step: 2800 | loss: 1.455966 | [ENTITY] precision: 0.0164, recall: 0.0284, f1: 0.0208
step: 2900 | loss: 1.446708 | [ENTITY] precision: 0.0168, recall: 0.0291, f1: 0.0213
step: 3000 | loss: 1.439551 | [ENTITY] precision: 0.0171, recall: 0.0295, f1: 0.0217
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1712, recall: 0.2890, f1: 0.2150
Best checkpoint
step: 3100 | loss: 1.354320 | [ENTITY] precision: 0.0225, recall: 0.0370, f1: 0.0280
step: 3200 | loss: 1.241586 | [ENTITY] precision: 0.0244, recall: 0.0405, f1: 0.0304
step: 3300 | loss: 1.187175 | [ENTITY] precision: 0.0245, recall: 0.0403, f1: 0.0304
step: 3400 | loss: 1.186945 | [ENTITY] precision: 0.0244, recall: 0.0400, f1: 0.0303
step: 3500 | loss: 1.188732 | [ENTITY] precision: 0.0254, recall: 0.0414, f1: 0.0315
step: 3600 | loss: 1.179723 | [ENTITY] precision: 0.0272, recall: 0.0440, f1: 0.0336
step: 3700 | loss: 1.173950 | [ENTITY] precision: 0.0285, recall: 0.0458, f1: 0.0351
step: 3800 | loss: 1.167012 | [ENTITY] precision: 0.0281, recall: 0.0453, f1: 0.0347
step: 3900 | loss: 1.176998 | [ENTITY] precision: 0.0286, recall: 0.0459, f1: 0.0352
step: 4000 | loss: 1.178386 | [ENTITY] precision: 0.0294, recall: 0.0471, f1: 0.0362
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.1958, recall: 0.3164, f1: 0.2419
Best checkpoint
step: 4100 | loss: 1.095819 | [ENTITY] precision: 0.0334, recall: 0.0531, f1: 0.0410
step: 4200 | loss: 1.037386 | [ENTITY] precision: 0.0322, recall: 0.0517, f1: 0.0397
step: 4300 | loss: 1.074321 | [ENTITY] precision: 0.0353, recall: 0.0561, f1: 0.0434
step: 4400 | loss: 1.084578 | [ENTITY] precision: 0.0377, recall: 0.0595, f1: 0.0462
step: 4500 | loss: 1.076819 | [ENTITY] precision: 0.0404, recall: 0.0629, f1: 0.0492
step: 4600 | loss: 1.059628 | [ENTITY] precision: 0.0407, recall: 0.0630, f1: 0.0495
step: 4700 | loss: 1.047896 | [ENTITY] precision: 0.0403, recall: 0.0624, f1: 0.0490
step: 4800 | loss: 1.043891 | [ENTITY] precision: 0.0402, recall: 0.0627, f1: 0.0490
step: 4900 | loss: 1.046900 | [ENTITY] precision: 0.0405, recall: 0.0630, f1: 0.0493
step: 5000 | loss: 1.032351 | [ENTITY] precision: 0.0409, recall: 0.0637, f1: 0.0498
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2194, recall: 0.3416, f1: 0.2672
Best checkpoint
step: 5100 | loss: 1.073183 | [ENTITY] precision: 0.0433, recall: 0.0647, f1: 0.0519
step: 5200 | loss: 0.983309 | [ENTITY] precision: 0.0501, recall: 0.0759, f1: 0.0603
step: 5300 | loss: 0.961690 | [ENTITY] precision: 0.0540, recall: 0.0808, f1: 0.0648
step: 5400 | loss: 0.934863 | [ENTITY] precision: 0.0536, recall: 0.0804, f1: 0.0643
step: 5500 | loss: 0.911897 | [ENTITY] precision: 0.0557, recall: 0.0835, f1: 0.0668
step: 5600 | loss: 0.908696 | [ENTITY] precision: 0.0575, recall: 0.0867, f1: 0.0691
step: 5700 | loss: 0.901405 | [ENTITY] precision: 0.0583, recall: 0.0874, f1: 0.0700
step: 5800 | loss: 0.885512 | [ENTITY] precision: 0.0589, recall: 0.0883, f1: 0.0706
step: 5900 | loss: 0.897590 | [ENTITY] precision: 0.0603, recall: 0.0904, f1: 0.0723
step: 6000 | loss: 0.888896 | [ENTITY] precision: 0.0627, recall: 0.0938, f1: 0.0752
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2441, recall: 0.3620, f1: 0.2916
Best checkpoint
step: 6100 | loss: 0.713476 | [ENTITY] precision: 0.0842, recall: 0.1244, f1: 0.1004
step: 6200 | loss: 0.825140 | [ENTITY] precision: 0.0813, recall: 0.1211, f1: 0.0973
step: 6300 | loss: 0.820365 | [ENTITY] precision: 0.0783, recall: 0.1154, f1: 0.0933
step: 6400 | loss: 0.812923 | [ENTITY] precision: 0.0808, recall: 0.1189, f1: 0.0962
step: 6500 | loss: 0.793197 | [ENTITY] precision: 0.0809, recall: 0.1184, f1: 0.0961
step: 6600 | loss: 0.775925 | [ENTITY] precision: 0.0839, recall: 0.1217, f1: 0.0993
step: 6700 | loss: 0.757296 | [ENTITY] precision: 0.0861, recall: 0.1245, f1: 0.1018
step: 6800 | loss: 0.738777 | [ENTITY] precision: 0.0898, recall: 0.1289, f1: 0.1058
step: 6900 | loss: 0.729418 | [ENTITY] precision: 0.0909, recall: 0.1301, f1: 0.1070
step: 7000 | loss: 0.718877 | [ENTITY] precision: 0.0928, recall: 0.1322, f1: 0.1090
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2299, recall: 0.3390, f1: 0.2740
step: 7100 | loss: 0.646099 | [ENTITY] precision: 0.1046, recall: 0.1511, f1: 0.1236
step: 7200 | loss: 0.689526 | [ENTITY] precision: 0.1038, recall: 0.1492, f1: 0.1224
step: 7300 | loss: 0.653381 | [ENTITY] precision: 0.1054, recall: 0.1485, f1: 0.1233
step: 7400 | loss: 0.645359 | [ENTITY] precision: 0.1092, recall: 0.1538, f1: 0.1277
step: 7500 | loss: 0.636903 | [ENTITY] precision: 0.1116, recall: 0.1570, f1: 0.1305
step: 7600 | loss: 0.610873 | [ENTITY] precision: 0.1179, recall: 0.1658, f1: 0.1378
step: 7700 | loss: 0.601239 | [ENTITY] precision: 0.1192, recall: 0.1668, f1: 0.1390
step: 7800 | loss: 0.587321 | [ENTITY] precision: 0.1213, recall: 0.1692, f1: 0.1413
step: 7900 | loss: 0.573096 | [ENTITY] precision: 0.1248, recall: 0.1728, f1: 0.1449
step: 8000 | loss: 0.557593 | [ENTITY] precision: 0.1288, recall: 0.1774, f1: 0.1493
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2412, recall: 0.3526, f1: 0.2864
step: 8100 | loss: 0.406336 | [ENTITY] precision: 0.1695, recall: 0.2139, f1: 0.1891
step: 8200 | loss: 0.441190 | [ENTITY] precision: 0.1552, recall: 0.2030, f1: 0.1759
step: 8300 | loss: 0.440819 | [ENTITY] precision: 0.1581, recall: 0.2120, f1: 0.1811
step: 8400 | loss: 0.441703 | [ENTITY] precision: 0.1591, recall: 0.2111, f1: 0.1815
step: 8500 | loss: 0.440534 | [ENTITY] precision: 0.1590, recall: 0.2109, f1: 0.1813
step: 8600 | loss: 0.429971 | [ENTITY] precision: 0.1641, recall: 0.2164, f1: 0.1867
step: 8700 | loss: 0.422504 | [ENTITY] precision: 0.1683, recall: 0.2210, f1: 0.1911
step: 8800 | loss: 0.417078 | [ENTITY] precision: 0.1710, recall: 0.2246, f1: 0.1941
step: 8900 | loss: 0.410318 | [ENTITY] precision: 0.1734, recall: 0.2273, f1: 0.1968
step: 9000 | loss: 0.406638 | [ENTITY] precision: 0.1752, recall: 0.2289, f1: 0.1985
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2445, recall: 0.3528, f1: 0.2888
step: 9100 | loss: 0.373392 | [ENTITY] precision: 0.1938, recall: 0.2545, f1: 0.2200
step: 9200 | loss: 0.369150 | [ENTITY] precision: 0.2022, recall: 0.2569, f1: 0.2263
step: 9300 | loss: 0.357514 | [ENTITY] precision: 0.2042, recall: 0.2591, f1: 0.2284
step: 9400 | loss: 0.349630 | [ENTITY] precision: 0.2105, recall: 0.2625, f1: 0.2337
step: 9500 | loss: 0.346784 | [ENTITY] precision: 0.2133, recall: 0.2658, f1: 0.2367
step: 9600 | loss: 0.342625 | [ENTITY] precision: 0.2130, recall: 0.2670, f1: 0.2370
step: 9700 | loss: 0.343915 | [ENTITY] precision: 0.2146, recall: 0.2685, f1: 0.2386
step: 9800 | loss: 0.344116 | [ENTITY] precision: 0.2163, recall: 0.2697, f1: 0.2401
step: 9900 | loss: 0.340398 | [ENTITY] precision: 0.2195, recall: 0.2730, f1: 0.2434
step: 10000 | loss: 0.338365 | [ENTITY] precision: 0.2214, recall: 0.2741, f1: 0.2449
Use val dataset
[EVAL] step:  500 | [ENTITY] precision: 0.2503, recall: 0.3572, f1: 0.2943
Best checkpoint

####################

Finish training nnshot-inter-10-5-seed0

Use test dataset
Successfully loaded checkpoint 'checkpoint/nnshot-inter-10-5-seed0.pth.tar'
[EVAL] step: 5000 | [ENTITY] precision: 0.3867, recall: 0.5203, f1: 0.4436
RESULT: precision: 0.3867, recall: 0.5203, f1:0.4436
ERROR ANALYSIS: fp: 0.0398, fn: 0.0291, within:0.0737, outer: 0.0907
